{"version":3,"sources":["running.svg","editor/lists.ts","editor/templates.ts","editor/consts.ts","editor/utils.ts","components/TemplateBlock.tsx","context/InitialState.ts","components/Element.tsx","components/Leaf.tsx","components/MarkButton.tsx","components/BlockButton.tsx","components/ListButton.tsx","components/Toolbar.tsx","components/FunctionButton.tsx","editor/seralise.ts","components/RichTextEditor.tsx","wraps/VoidBlocks.ts","editor/handlers.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["EditListPlugin","types","typeItem","withEditList","onKeyDown","Editor","Transforms","Element","indentListItem","editor","increaseItemDepth","dedentListItem","decreaseItemDepth","toggleListBlock","type","isSelectionInList","currentList","getCurrentList","selection","console","log","currentListNode","currentListPath","setNodes","at","unwrapList","wrapInList","findNextTemplate","previousPoint","before","unit","children","nextTemplateNodeEntry","next","match","node","voids","nextTemplatePath","select","findPreviousTemplate","nextPoint","after","lastTemplateNodeEntry","previous","lastTemplatePath","HOTKEYS","BLOCK_HOTKEYS","FUNCTION_HOTKEYS","LIST_TYPES","toggleBlock","format","isActive","isBlockActive","isList","includes","unwrapNodes","n","isEditor","SlateElement","isElement","split","newProperties","block","wrapNodes","toggleMark","isMarkActive","removeMark","addMark","nodes","marks","TemplateBlock","attributes","element","selected","useSelected","focused","useFocused","useEditor","useState","defaultValue","chosenValue","setChosenValue","opts","options","setOptions","name","setName","editName","setEditName","menuOpen","setMenuOpen","selectRef","useRef","handleChange","useCallback","newValue","actionMeta","changeProps","handleNameChange","evt","newName","target","value","path","ReactEditor","findPath","newProps","defaultStyles","boxShadow","transform","transition","className","contentEditable","style","position","zIndex","placeholder","onInput","e","key","ref","styles","customSelectStyles","theme","customSelectTheme","onChange","onCreateOption","inputValue","newOption","createOption","onMenuOpen","onMenuClose","onClick","tabIndex","icon","insertTemplateBlock","templateBlock","text","insertNodes","move","label","toLowerCase","replace","control","provided","state","minHeight","height","paddingTop","valueContainer","getValue","currentOption","margin","width","length","selectProps","minWidth","input","indicatorSeparator","display","indicatorsContainer","menu","marginTop","menuIsOpen","option","padding","noOptionsMessage","borderRadius","spacing","baseUnit","InitialState","Leaf","leaf","bold","code","italic","underline","pretemplate","backgroundColor","MarkButton","alt","useSlate","onMouseDown","preventDefault","title","BlockButton","ListButton","checkActive","Toolbar","FunctionButton","fn","toClipboardMD","navigator","clipboard","writeText","preprocessed","map","preprocessMDNode","processor","unified","use","slateToRemark","stringify","bullet","ast","runSync","textLines","tftBlocks","s","join","matchAll","toRemove","tft","matched","index","fPos","val","idx","filter","concat","toMarkdown","then","window","alert","templatesToText","newNode","Text","isText","strong","emphasis","depth","ordered","toHTML","nodeToHTML","nodeText","escapeHTML","toClipboardHTML","item","Blob","RichTextEditor","JSON","parse","localStorage","getItem","setValue","setTarget","insertTemplate","setInsertTemplate","renderElement","props","renderLeaf","useMemo","withHistory","withReact","isInline","isVoid","voidElementNames","elemType","withVoids","createEditor","useEffect","content","setItem","Range","isCollapsed","edges","start","distance","beforeRange","range","beforeText","string","blob","fileDownloadUrl","URL","createObjectURL","tempLink","document","createElement","href","setAttribute","click","remove","fileSelector","addEventListener","event","files","file","fr","FileReader","readAsText","onload","loaded","result","spellCheck","autoFocus","listKeyDown","hotkey","isHotkey","hotkeyHandler","onSelect","chrome","toDOMPoint","focus","parentElement","scrollIntoView","behavior","App","modalOpen","setModalOpen","src","logo","isOpen","onRequestClose","contentLabel","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.586d09b3.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/running.bda043eb.svg\";","import { Editor as SlateEditor, NodeEntry } from \"slate\";\r\nimport { EditListPlugin } from '@productboard/slate-edit-list';\r\n\r\nconst editListOptions = {\r\n    types: [\"bulleted-list\", \"numbered-list\"],\r\n    typeItem: \"list-item\",\r\n}\r\n\r\nexport const [withEditList, onKeyDown, { Editor, Element, Transforms }] = EditListPlugin(editListOptions);\r\n\r\nexport const indentListItem = (editor: SlateEditor): void => {\r\n    Transforms.increaseItemDepth(editor)\r\n}\r\n\r\nexport const dedentListItem = (editor: SlateEditor): void => {\r\n    Transforms.decreaseItemDepth(editor)\r\n}\r\n\r\nexport const makeListBlock = (editor: SlateEditor, type?: string): void => {\r\n    Transforms.wrapInList(editor, type)\r\n}\r\n\r\nexport const unmakeListBlock = (editor: SlateEditor): void => {\r\n    Transforms.unwrapList(editor)\r\n}\r\n\r\nexport const toggleListBlock = (editor: SlateEditor, type?: string): void => {\r\n    const currentlyInList = Editor.isSelectionInList(editor)\r\n    if (!currentlyInList)\r\n        Transforms.wrapInList(editor, type);\r\n    else {\r\n        // check if the current list is of the same type\r\n        let currentList = Editor.getCurrentList(editor, editor.selection) as NodeEntry;\r\n        console.log(currentList);\r\n        let [currentListNode, currentListPath] = currentList;\r\n        // if not, change it to the other type\r\n        if (type && currentListNode.type !== type) {\r\n            Transforms.setNodes(editor, {type}, {at: currentListPath})\r\n        } else {\r\n            Transforms.unwrapList(editor);\r\n        }\r\n    }\r\n}","import { Editor, Node, NodeEntry, Location, Transforms } from 'slate';\r\n\r\n// utility functions for finding and navigating to template blocks in the editor\r\n// actually they kinda work - if you have more than one block present, it will go two blocks back\r\n// however, it will skip over the nearest block for reasons i can't understand at the moment\r\n// also, selecting the template should not just take you to the block but also allow you to select the options\r\n// TODO: fix the selection issues\r\n\r\nexport const findNextTemplate = (editor: Editor, at?: Location): void => {\r\n    let previousPoint = Editor.before(editor, at || editor.selection!, {unit: \"block\"})\r\n    console.log(previousPoint, editor.children)\r\n    let nextTemplateNodeEntry = (Editor.next(editor, {at: previousPoint, match: (node: Node) => node.type === \"template-block\", voids: true}) as NodeEntry)\r\n    // console.log(nextTemplateNodeEntry)\r\n    if (!!nextTemplateNodeEntry) {\r\n        let [,nextTemplatePath] = nextTemplateNodeEntry\r\n        Transforms.select(editor, nextTemplatePath);\r\n    }\r\n}\r\n\r\nexport const findPreviousTemplate = (editor: Editor, at?: Location): void => {\r\n    let nextPoint = Editor.after(editor, at || editor.selection!, {unit: \"block\"})\r\n    console.log(nextPoint, editor.children)\r\n    let lastTemplateNodeEntry = (Editor.previous(editor, {at: nextPoint, match: (node: Node) => node.type === \"template-block\", voids: true}) as NodeEntry)\r\n    // console.log(lastTemplateNodeEntry)\r\n    if (!!lastTemplateNodeEntry) {\r\n        let [,lastTemplatePath] = lastTemplateNodeEntry\r\n        Transforms.select(editor, lastTemplatePath)\r\n    }\r\n}","import { Editor, Location } from 'slate';\r\nimport { findNextTemplate, findPreviousTemplate } from './templates';\r\n\r\nexport const HOTKEYS: Record<string, string> = {\r\n    'mod+b': 'bold',\r\n    'mod+i': 'italic',\r\n    'mod+u': 'underline',\r\n}\r\n\r\nexport const BLOCK_HOTKEYS: Record<string, string> = {\r\n    'mod+alt+1': 'heading-one',\r\n    'mod+alt+2': 'heading-two',\r\n    'mod+alt+3': 'heading-three',\r\n    'mod+alt+4': 'heading-four',\r\n    'mod+.': 'bulleted-list',\r\n    'mod+/': 'numbered-list',\r\n}\r\n\r\nexport const TEMPLATE_NAV_HOTKEYS: Record<string, (editor: Editor, at?: Location) => void> = {\r\n    'mod+]': findNextTemplate,\r\n    'mod+[': findPreviousTemplate,\r\n}\r\n\r\nexport const FUNCTION_HOTKEYS: Record<string, (editor: Editor) => void> = {\r\n    'mod+]': findNextTemplate,\r\n    'mod+[': findPreviousTemplate,\r\n}\r\n\r\nexport const LIST_TYPES: string[] = ['numbered-list', 'bulleted-list']","import { Editor, Transforms, Element as SlateElement } from 'slate';\r\nimport { LIST_TYPES } from './consts';\r\n\r\nexport const toggleBlock = (editor: Editor, format: string) => {\r\n    const isActive = isBlockActive(editor, format);\r\n    const isList = LIST_TYPES.includes(format)\r\n\r\n    Transforms.unwrapNodes(editor, {\r\n        match: (n) => !Editor.isEditor(n) && SlateElement.isElement(n) && LIST_TYPES.includes(n.type as string),\r\n        split: true\r\n    })\r\n\r\n    const newProperties: Partial<SlateElement> = {\r\n        type: isActive ? 'paragraph' : isList ? 'list-item' : format,\r\n    }\r\n    Transforms.setNodes(editor, newProperties)\r\n    \r\n    if (!isActive && isList) {\r\n        const block = { type: format, children: [] }\r\n        Transforms.wrapNodes(editor, block)\r\n    }\r\n}\r\n\r\nexport const toggleMark = (editor: Editor, format: string) => {\r\n    const isActive = isMarkActive(editor, format)\r\n\r\n    if (isActive)\r\n        Editor.removeMark(editor, format)\r\n    else\r\n        Editor.addMark(editor, format, true)\r\n}\r\n\r\nexport const isBlockActive = (editor: Editor, format: string) => {\r\n    const [match] = Editor.nodes(editor, {\r\n        match: n => !Editor.isEditor(n) && SlateElement.isElement(n) && n.type === format,\r\n    })\r\n        \r\n    return !!match\r\n}\r\n\r\nexport const isMarkActive = (editor: Editor, format: string) => {\r\n    const marks = Editor.marks(editor);\r\n    return marks ? marks[format] === true : false\r\n}","import React, { useCallback, useRef, useState } from 'react'\r\nimport { Editor, Transforms } from 'slate';\r\nimport { RenderElementProps, ReactEditor, useFocused, useSelected, useEditor } from 'slate-react'\r\nimport CreatableSelect from 'react-select/creatable'\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\nimport { ValueType } from 'react-select';\r\nimport AutoSizeInput from \"react-input-autosize\";\r\n\r\ninterface TemplateBlockProps {\r\n    name?: string;\r\n    opts?: {label:string, value:string}[];\r\n    defaultValue?: {label:string,value:string};\r\n}\r\n\r\n// TODO: add the ability to set the options while the template block is focused/selected\r\nexport const TemplateBlock: React.FC<RenderElementProps> = ({ attributes, children, element }) => {\r\n    const selected = useSelected();\r\n    const focused = useFocused();\r\n    const editor = useEditor();\r\n\r\n    // this next line looks ugly af but i'm not sure how else to do it\r\n    const [chosenValue, setChosenValue] = useState<ValueType<{label:string, value:string},false>>(element.defaultValue ? (element.defaultValue as {label:string,value:string}) : null as ValueType<{label:string,value:string}, false>);\r\n    const [options, setOptions] = useState<{label:string,value:string}[]>(element.opts ? element.opts as {label:string, value:string}[] : [])\r\n    const [name, setName] = useState<string>(element.name as string);\r\n    const [editName, setEditName] = useState(false);\r\n    const [menuOpen, setMenuOpen] = useState(false);\r\n    \r\n    // probably shouldn't be using \"any\" as the type here but idk what else to do lol\r\n    const selectRef = useRef<any>(null);\r\n    // const elementRef = useRef<HTMLSpanElement>(null);\r\n    // const editorSelection = useRef<any>(editor.selection);\r\n    // const [selectActive, setSelectActive] = useState(false);\r\n\r\n    const handleChange = useCallback((newValue: any, actionMeta: any) => {\r\n        setChosenValue(newValue);\r\n        changeProps({defaultValue: newValue})\r\n        // eslint-disable-next-line\r\n    }, [setChosenValue])\r\n    \r\n    const handleCreate = (inputValue: any) => {\r\n        const newOption = createOption(inputValue);\r\n        setOptions([...options, newOption])\r\n        setChosenValue(newOption);\r\n        changeProps({opts: [...options, newOption], defaultValue: newOption})\r\n    }\r\n    \r\n    const handleNameChange = useCallback((evt: React.FormEvent) => {\r\n        let newName = (evt.target as HTMLInputElement).value\r\n        setName(newName);\r\n        changeProps({name: newName})\r\n        // eslint-disable-next-line\r\n    }, [setName])\r\n    \r\n    const changeProps = useCallback(({name, opts, defaultValue}: TemplateBlockProps) => {\r\n        // console.log(\"changeProps called\")\r\n        let path = ReactEditor.findPath(editor, element)\r\n        let newProps = {name, opts, defaultValue}\r\n        // console.log(path, newProps, editor.children)\r\n        Transforms.setNodes(editor, newProps, {at:path})\r\n        // eslint-disable-next-line\r\n    }, [])\r\n    \r\n    // useEffect(() => {\r\n    //     console.log(selectRef.current)\r\n    //     console.log(elementRef.current)\r\n    // }, [selectRef, elementRef])\r\n    \r\n    // somewhat unsafe but it works\r\n    // useEffect(() => {\r\n    //     if (focused && selected && !!selectRef) {\r\n    //         editorSelection.current = editor.selection\r\n    //         selectRef!.current!.focus()\r\n    //         // setSelectActive(true);\r\n    //     }\r\n    // }, [focused, selected])\r\n    \r\n    // TODO: fix navigation\r\n    // const onKeyDown = (event: any) => {\r\n    //     for (const hotkey in TEMPLATE_NAV_HOTKEYS) {\r\n    //         if (isHotkey(hotkey, event)) {\r\n    //             event.preventDefault();\r\n    //             const fn = TEMPLATE_NAV_HOTKEYS[hotkey];\r\n    //             console.log(editorSelection.current)\r\n    //             fn(editor, editorSelection.current)\r\n    //         }\r\n    //     }\r\n    // }\r\n    \r\n\r\n    // const onKeyDown = (event: any) => {\r\n    //     console.log(\"keyDown event captured\")\r\n    //     switch (event.key) {\r\n    //         case \"Enter\":\r\n    //             event.preventDefault();\r\n    //             if (focused && selected && !!selectRef && !selectActive) {\r\n    //                 editorSelection.current = editor.selection;\r\n    //                 selectRef.current.focus();\r\n    //                 console.log(\"Should focus selection box\")\r\n    //                 setSelectActive(true);\r\n    //             } else if (selectActive) {\r\n    //                 console.log(\"Should refocus to editor\")\r\n    //                 // refocus to parent\r\n    //             }\r\n    //     }\r\n    // }\r\n\r\n    // this fix using the onmenuclose and onmenuopen hooks seems to work, but i'm not sure how safe it is\r\n    const defaultStyles: React.CSSProperties = {\r\n        boxShadow: selected && focused ? '0 0 0 2px #b4d5ff' : 'none',\r\n        transform: `translateY(${editName ? 0 : 2}px)`,\r\n        transition: \"0.3s ease all\"\r\n    }\r\n\r\n    const focusedStyles: React.CSSProperties = {\r\n        position: \"relative\",\r\n        zIndex: 99\r\n    }\r\n\r\n    return (\r\n        <span {...attributes}\r\n            className=\"template-block\"\r\n            contentEditable={false}\r\n            style={menuOpen ? {...defaultStyles, ...focusedStyles} : defaultStyles}>\r\n            {editName ?\r\n            (\r\n                <div className=\"content\">\r\n                    <AutoSizeInput placeholder=\"Name this field...\" value={name} onInput={handleNameChange} onKeyDown={e => e.key === \"Enter\" && setEditName(!editName)} />\r\n                </div>\r\n            )\r\n            : (<CreatableSelect\r\n                    ref={selectRef}\r\n                    styles={customSelectStyles} theme={customSelectTheme}\r\n                    placeholder={name}\r\n                    onChange={handleChange} onCreateOption={handleCreate}\r\n                    onMenuOpen={() => setMenuOpen(true)} onMenuClose={() => setMenuOpen(false)}\r\n                    value={chosenValue} options={options} />)}\r\n            <button className=\"name-setter\"\r\n                onClick={() => {\r\n                    setEditName(!editName)\r\n                }}\r\n                tabIndex={-1}\r\n            ><InlineIcon icon=\"bi:gear-fill\" /></button>\r\n            {children}\r\n        </span>\r\n    )\r\n}\r\n\r\nexport const insertTemplateBlock = (editor: Editor, {name, opts, defaultValue}: TemplateBlockProps) => {\r\n    const templateBlock = { type: \"template-block\", name, opts, defaultValue, children: [{text: ''}] }\r\n    Transforms.insertNodes(editor, templateBlock);\r\n    Transforms.move(editor);\r\n}\r\n\r\nconst createOption = (label: string) => ({\r\n    label,\r\n    value: label.toLowerCase().replace(/\\W/g, '_')\r\n})\r\n\r\n// auto width: https://stackoverflow.com/questions/46571811/react-select-auto-size-width\r\n// modify height: https://stackoverflow.com/questions/54218351/changing-height-of-react-select-component\r\nconst customSelectStyles = {\r\n    control: (provided: any, state: any) => ({\r\n        ...provided,\r\n        minHeight: \"1.4em\",\r\n        height: \"1.4em\",\r\n        paddingTop: \"1px\",\r\n    }),\r\n    valueContainer: (provided: any, state: any) => {\r\n        // console.log(state);\r\n        let [currentOption] = state.getValue();\r\n        // console.log(currentOption)\r\n        return ({\r\n            ...provided,\r\n            margin: \"0 0 0 4px\",\r\n            transform: \"translateY(-2px)\",\r\n            width: `${(currentOption ? currentOption.label.length : state.selectProps.placeholder ? state.selectProps.placeholder.length : 5) + 2}ex`,\r\n            minWidth: \"5ex\",\r\n        })\r\n    },\r\n    input: (provided: any, state: any) => ({\r\n        ...provided,\r\n        margin: \"0px\",\r\n    }),\r\n    indicatorSeparator: (state: any) => ({\r\n        display: 'none',\r\n    }),\r\n    indicatorsContainer: (provided: any, state: any) => ({\r\n        ...provided,\r\n        height: '1.4em',\r\n        transform: \"translateY(-2px)\"\r\n    }),\r\n    menu: (provided: any, state: any) => ({\r\n        ...provided,\r\n        marginTop: 0,\r\n        zIndex: `${state.selectProps.menuIsOpen ? 999 : \"inherit\"}`\r\n    }),\r\n    option: (provided: any) => ({\r\n        ...provided,\r\n        padding: \"5px\",\r\n    }),\r\n    noOptionsMessage: (provided: any) => ({\r\n        ...provided,\r\n        padding: \"5px 0\",\r\n    }),\r\n}\r\n\r\nconst customSelectTheme = (theme: any) => ({\r\n    ...theme,\r\n    borderRadius: 0,\r\n    spacing: {\r\n        ...theme.spacing,\r\n        baseUnit: 0,\r\n    },\r\n})","\r\nexport const InitialState = [\r\n    {\r\n        type: \"paragraph\",\r\n        children: [\r\n            {text: \"Type in {{ to create a template block like this (the gear icon allows you to name the field): \"},\r\n            {\r\n                type: \"template-block\",\r\n                name: \"sex\", \r\n                opts: [{label: \"male\", value: \"male\"}, {label: \"female\", value: \"female\"}],\r\n                defaultValue: {label: 'male', value: 'male'},\r\n                children: [{text: ''}],\r\n            },\r\n            {text: ''},\r\n        ]\r\n    },\r\n    {\r\n        type: \"paragraph\",\r\n        children: [\r\n            {text: \"FastDischarge also comes with all the rich text editing features you know and love!\"}\r\n        ]\r\n    },\r\n]","import React from 'react'\r\nimport { RenderElementProps } from \"slate-react\";\r\nimport { TemplateBlock } from './TemplateBlock';\r\n\r\nexport const Element: React.FC<RenderElementProps> = ({ attributes, children, element }) => {\r\n    switch (element.type) {\r\n        case 'bulleted-list':\r\n            return <ul {...attributes}>{children}</ul>\r\n        case 'numbered-list':\r\n            return <ol {...attributes}>{children}</ol>\r\n        case 'heading-one':\r\n            return <h1 {...attributes}>{children}</h1>\r\n        case 'heading-two':\r\n            return <h2 {...attributes}>{children}</h2>\r\n        case 'heading-three':\r\n            return <h3 {...attributes}>{children}</h3>\r\n        case 'heading-four':\r\n            return <h4 {...attributes}>{children}</h4>\r\n        case 'list-item':\r\n            return <li {...attributes}>{children}</li>\r\n        case 'template-block':\r\n            return <TemplateBlock attributes={attributes} children={children} element={element} />\r\n        default:\r\n            return <p {...attributes}>{children}</p>\r\n    }\r\n}\r\n","import React from 'react'\r\nimport { RenderLeafProps } from 'slate-react'\r\n\r\nexport const Leaf: React.FC<RenderLeafProps> = ({ attributes, children, leaf }) => {\r\n    if (leaf.bold)\r\n        children = <strong>{children}</strong>\r\n        \r\n    if (leaf.code)\r\n        children = <code>{children}</code>\r\n\r\n    if (leaf.italic)\r\n        children = <em>{children}</em>\r\n\r\n    if (leaf.underline)\r\n        children = <u>{children}</u>\r\n        \r\n    if (leaf.pretemplate)\r\n        children = <span style={{borderRadius: \"5px\", backgroundColor: \"#ddd\"}}>{children}</span>\r\n        \r\n    return <span {...attributes}>{children}</span>\r\n}\r\n","import React from 'react';\r\nimport { InlineIcon } from \"@iconify/react-with-api\";\r\nimport { useSlate } from 'slate-react';\r\nimport { isMarkActive, toggleMark } from '../editor/utils';\r\n\r\ninterface Props {\r\n    format: string;\r\n    icon: string;\r\n    alt?: string;\r\n}\r\n\r\nexport const MarkButton: React.FC<Props> = ({ format, icon, alt }) => {\r\n    const editor = useSlate();\r\n    const isActive = isMarkActive(editor, format);\r\n\r\n    return (\r\n        <li>\r\n            <button className={isActive ? \"active\" : \"\"}\r\n                onMouseDown={evt => {\r\n                evt.preventDefault();\r\n                toggleMark(editor, format)\r\n            }} title={alt}>\r\n                <InlineIcon icon={icon} />\r\n            </button>\r\n        </li>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport { InlineIcon } from \"@iconify/react-with-api\";\r\nimport { useSlate } from 'slate-react';\r\nimport { toggleBlock, isBlockActive } from '../editor/utils';\r\n\r\ninterface Props {\r\n    format: string;\r\n    icon: string;\r\n    alt?: string;\r\n}\r\n\r\nexport const BlockButton: React.FC<Props> = ({ format, icon, alt }) => {\r\n    const editor = useSlate();\r\n    const isActive = isBlockActive(editor, format);\r\n\r\n    return (\r\n        <li>\r\n            <button className={isActive ? \"active\" : \"\"}\r\n                onMouseDown={evt => {\r\n                evt.preventDefault();\r\n                toggleBlock(editor, format)\r\n            }} title={alt}>\r\n                <InlineIcon icon={icon} />\r\n            </button>\r\n        </li>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport { InlineIcon } from \"@iconify/react-with-api\";\r\nimport { Editor as SlateEditor } from \"slate\";\r\nimport { useSlate } from 'slate-react';\r\nimport { Editor, toggleListBlock } from '../editor/lists';\r\n\r\ninterface Props {\r\n    format: string;\r\n    icon: string;\r\n    alt?: string;\r\n}\r\n\r\nexport const ListButton: React.FC<Props> = ({ format, icon, alt }) => {\r\n    const editor = useSlate();\r\n    const isActive = checkActive(editor, format);\r\n\r\n    return (\r\n        <li>\r\n            <button className={isActive ? \"active\" : \"\"}\r\n                onMouseDown={evt => {\r\n                evt.preventDefault();\r\n                toggleListBlock(editor, format)\r\n            }} title={alt}>\r\n                <InlineIcon icon={icon} />\r\n            </button>\r\n        </li>\r\n    )\r\n}\r\n\r\nconst checkActive = (editor: SlateEditor, format: string) => {\r\n    const currentList = Editor.getCurrentList(editor);\r\n    if (currentList) {\r\n        const [listNode] = currentList;\r\n        return listNode.type === format;\r\n    }\r\n}","import React from 'react'\r\n\r\nexport const Toolbar: React.FC = ({ children }) => {\r\n    return (\r\n        <div className=\"toolbar-container\">\r\n            <ul>\r\n                {children}\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\nimport { Editor } from 'slate'\r\nimport { useSlate } from 'slate-react';\r\n\r\ninterface Props {\r\n    fn: (editor: Editor) => void;\r\n    icon: string;\r\n    alt?: string;\r\n}\r\n\r\nexport const FunctionButton: React.FC<Props> = ({fn, icon, alt}) => {\r\n    const editor = useSlate();\r\n    \r\n    return (\r\n        <li>\r\n            <button onMouseDown={evt => {\r\n                evt.preventDefault();\r\n                fn(editor)\r\n            }} title={alt}>\r\n                <InlineIcon icon={icon} />\r\n            </button>\r\n        </li>\r\n    )\r\n}\r\n","import { Editor, Node, Text } from 'slate';\r\nimport unified from 'unified';\r\nimport { slateToRemark } from 'remark-slate-transformer';\r\nimport stringify from 'remark-stringify';\r\nimport escapeHTML from \"escape-html\";\r\nimport * as clipboard from \"clipboard-polyfill\";\r\n\r\n// two packages seem to work to this end:\r\n// https://github.com/accordproject/markdown-transform/tree/master/packages/markdown-slate/\r\n// https://github.com/inokawa/remark-slate-transformer\r\n\r\nexport const toMarkdown = (editor: Editor): string => {\r\n    const preprocessed = editor.children.map(preprocessMDNode)\r\n    const processor = unified().use(slateToRemark).use(stringify, {bullet: \"-\"})\r\n    const ast = processor.runSync({\r\n        type: \"root\",\r\n        children: preprocessed,\r\n    });\r\n    const text = processor.stringify(ast);\r\n    // i can't figure out how to remove the unnecessary line breaks in the lists using remark's serialiser\r\n    // so i'm going to do it the stupid way using regex\r\n    let textLines = text.split(\"\\n\")\r\n    // convert to a boolean index of where there are list items or not\r\n    // this will miss empty list items - the serialiser only introduces the spaces after the bullet point when there is content in the item\r\n    let matches = textLines.map(s => !!s.match(/^\\s*(-|[0-9A-Za-z]+\\.)\\s+/g))\r\n    // look for a true/false/true block\r\n    // it's easier if you just convert it to a string and use regex but again this feels very dumb to me for some reason\r\n    let matchString = matches.map(s => s ? 't' : 'f').join('')\r\n    let tftBlocks = matchString.matchAll(/t(ft)+/g)\r\n    let toRemove: number[] = []\r\n    for (let tft of tftBlocks) {\r\n        let [matched] = tft;\r\n        let { index } = tft;\r\n        // i wish there was a way to do this without the filter or the spread operator but js is dumb\r\n        let fPos = [...matched].map((val, idx) => (val === 'f') ? (index!+idx) : -1).filter(val => (val >= 0))\r\n        toRemove = toRemove.concat(fPos)\r\n    }\r\n    let finalLines = textLines.map((val, idx) => (!toRemove.includes(idx)) ? val : null).filter(val => val !== null)\r\n    let fixedText = finalLines.join('\\n')\r\n\r\n    return fixedText;\r\n}\r\n\r\nexport const toClipboardMD = (editor: Editor): void => {\r\n    navigator.clipboard.writeText(toMarkdown(editor)).then(() => {\r\n        window.alert(\"Copied successfully!\")\r\n    }, () => {\r\n        window.alert(\"Copying failed!\")\r\n    })\r\n}\r\n\r\nconst templatesToText = (node: Node): Node => {\r\n    let newNode = {...node};\r\n\r\n    if (newNode.children)\r\n        newNode.children = (newNode.children as Node[]).map(templatesToText)\r\n\r\n    switch (newNode.type) {\r\n        case \"template-block\":\r\n            return {text: (newNode.defaultValue ? (newNode.defaultValue as {label:string,value:string}).label : \"\")}\r\n        default:\r\n            return newNode\r\n    }\r\n}\r\n\r\nconst preprocessMDNode = (node: Node): Node => {\r\n    let newNode = {...node};\r\n    // preprocess text nodes so that they return the right formatting\r\n    if (Text.isText(newNode)) {\r\n        newNode.strong = newNode.bold\r\n        newNode.emphasis = newNode.italic\r\n    }\r\n\r\n    if (newNode.children)\r\n        newNode.children = (newNode.children as Node[]).map(preprocessMDNode)\r\n\r\n    switch (newNode.type) {\r\n        case \"heading-one\":\r\n            return {...newNode, type: \"heading\", depth: 1}\r\n        case \"heading-two\":\r\n            return {...newNode, type: \"heading\", depth: 2}\r\n        case \"heading-three\":\r\n            return {...newNode, type: \"heading\", depth: 3}\r\n        case \"heading-four\":\r\n            return {...newNode, type: \"heading\", depth: 4}\r\n        case \"numbered-list\":\r\n            return {...newNode, type: \"list\", ordered: true}\r\n        case \"bulleted-list\":\r\n            return {...newNode, type: \"list\", ordered: false}\r\n        case \"list-item\":\r\n            return {...newNode, type: \"listItem\"}\r\n        case \"template-block\":\r\n            return {text: (newNode.defaultValue ? (newNode.defaultValue as {label:string,value:string}).label : \"\")}\r\n        default:\r\n            return newNode\r\n    }\r\n}\r\n\r\nexport const toHTML = (editor: Editor): string => {\r\n    const preprocessed = editor.children.map(templatesToText)\r\n    return preprocessed.map(nodeToHTML).join('')\r\n}\r\n\r\nconst nodeToHTML = (node: Node): string => {\r\n    if (Text.isText(node)) {\r\n        let nodeText = escapeHTML(node.text)\r\n        \r\n        if (node.bold)\r\n            nodeText = `<strong>${nodeText}</strong>`\r\n\r\n        if (node.italic)\r\n            nodeText = `<em>${nodeText}</em>`\r\n\r\n        if (node.underline)\r\n            nodeText = `<u>${nodeText}</u>`\r\n        \r\n        return nodeText\r\n    }\r\n    \r\n    const children = node.children.map((n: Node) => nodeToHTML(n)).join('')\r\n\r\n    switch (node.type) {\r\n        case \"heading-one\":\r\n            return `<h1>${children}</h1>`\r\n        case \"heading-two\":\r\n            return `<h2>${children}</h2>`\r\n        case \"heading-three\":\r\n            return `<h3>${children}</h3>`\r\n        case \"heading-four\":\r\n            return `<h4>${children}</h4>`\r\n        case \"bulleted-list\":\r\n            return `<ul>${children}</ul>`\r\n        case \"numbered-list\":\r\n            return `<ol>${children}</ol>`\r\n        case \"list-item\":\r\n            return `<li>${children}</li>`\r\n        default:\r\n            return children\r\n    }\r\n}\r\n\r\nexport const toClipboardHTML = (editor: Editor): void => {\r\n    // can't use the new async clipboard API because it doesn't support rich text\r\n    // i normally try to avoid installing packages if i can help it but anyway, here we are\r\n    const item = new clipboard.ClipboardItem({\r\n        \"text/html\": new Blob([toHTML(editor)], {type: \"text/html\"}),\r\n    })\r\n    clipboard.write([item]);\r\n}","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport { Editable, withReact, Slate, ReactEditor } from \"slate-react\";\r\nimport { createEditor, Editor, Location, Node, Range, Transforms } from \"slate\";\r\nimport { withHistory } from \"slate-history\";\r\nimport SimpleBar from \"simplebar-react\";\r\nimport \"simplebar/dist/simplebar.min.css\"\r\n\r\nimport { withEditList, onKeyDown as listKeyDown, indentListItem, dedentListItem } from \"./../editor/lists\"\r\nimport { hotkeyHandler } from '../editor/handlers'\r\nimport { withVoids } from './../wraps/VoidBlocks';\r\nimport { insertTemplateBlock } from \"./TemplateBlock\";\r\nimport { InitialState } from \"./../context/InitialState\";\r\n\r\nimport { Element } from './Element';\r\nimport { Leaf } from './Leaf';\r\nimport { MarkButton } from \"./MarkButton\";\r\nimport { BlockButton } from \"./BlockButton\";\r\nimport { ListButton } from \"./ListButton\";\r\nimport { Toolbar } from './Toolbar'\r\nimport { FunctionButton } from \"./FunctionButton\";\r\nimport { toClipboardHTML, toClipboardMD } from \"../editor/seralise\";\r\n\r\nexport const RichTextEditor: React.FC = () => {\r\n    const [value, setValue] = useState<Node[]>(JSON.parse((localStorage.getItem(\"content\") as string)) || InitialState);\r\n    const [target, setTarget] = useState<Location | null>();\r\n    const [insertTemplate, setInsertTemplate] = useState(false);\r\n    const renderElement = useCallback(props => <Element {...props} />, [])\r\n    const renderLeaf = useCallback(props => <Leaf {...props} />, [])\r\n\r\n    const editor = useMemo(() => withHistory(withReact(withEditList(withVoids(createEditor())))), [])\r\n    \r\n    // useEffect hook for inserting template tags\r\n    useEffect(() => {\r\n        if (!!target && insertTemplate) {\r\n            Transforms.select(editor, target!);\r\n            insertTemplateBlock(editor, {})\r\n            setInsertTemplate(false);\r\n            setTarget(null);\r\n        }\r\n        // eslint-disable-next-line\r\n    }, [target])\r\n    \r\n    const exportTemplateAsFile = () => {\r\n        const blob = new Blob([JSON.stringify(editor.children)], {type: \"application/json\"})\r\n        const fileDownloadUrl = URL.createObjectURL(blob);\r\n        let tempLink = document.createElement(\"a\")\r\n        tempLink.href = fileDownloadUrl;\r\n        tempLink.setAttribute(\"download\", \"template.fdt\")\r\n        tempLink.setAttribute(\"target\", \"_blank\")\r\n        tempLink.click()\r\n        tempLink.remove()\r\n    }\r\n    \r\n    const loadTemplateFromFile = () => {\r\n        // see here: \r\n        // https://codepen.io/rkotze/pen/zjRXYr\r\n        // https://stackoverflow.com/questions/57007536/react-js-reading-from-a-local-file\r\n        // console.log(\"File popup should now appear\")\r\n        const fileSelector = document.createElement(\"input\");\r\n        fileSelector.setAttribute(\"type\", \"file\")\r\n        fileSelector.click()\r\n        fileSelector.addEventListener(\"change\", event => {\r\n            if (fileSelector.files && fileSelector.files.length >= 1) {\r\n                let file = fileSelector.files![0], fr = new FileReader();\r\n                fr.readAsText(file)\r\n                fr.onload = event => {\r\n                    let loaded = JSON.parse((event.target!.result as string))\r\n                    setValue(loaded)\r\n                }\r\n            }\r\n        })\r\n    }\r\n    \r\n    return (\r\n        <Slate editor={editor} value={value} onChange={value => {\r\n            setValue(value);\r\n            const content = JSON.stringify(value);\r\n            localStorage.setItem(\"content\", content)\r\n            // console.log(value)\r\n\r\n            // you should be able to replace this code block with this addon:\r\n            // https://github.com/ianstormtaylor/slate-plugins/tree/master/packages/slate-auto-replace\r\n            const { selection } = editor;\r\n            // if nothing is currently selected under the cursor\r\n            if (selection && Range.isCollapsed(selection)) {\r\n                const [start] = Range.edges(selection);\r\n                // if the two characters beforce the cursor are {{, select them and replace with a template block\r\n                const before = Editor.before(editor, start, {distance: 2})\r\n                const beforeRange = before && Editor.range(editor, before, start)\r\n                const beforeText = beforeRange && Editor.string(editor, beforeRange)\r\n                const beforeMatch = beforeText && beforeText.match(/\\{\\{/);\r\n                if (beforeMatch) {\r\n                    setInsertTemplate(true);\r\n                    setTarget(beforeRange as Location);\r\n                }\r\n            }\r\n        }}>\r\n            <Toolbar>\r\n                <MarkButton format=\"bold\" icon=\"gridicons:bold\" alt=\"Bold (Ctrl+B)\" />\r\n                <MarkButton format=\"italic\" icon=\"gridicons:italic\" alt=\"Italic (Ctrl+I)\" />\r\n                <MarkButton format=\"underline\" icon=\"gridicons:underline\" alt=\"Underline (Ctrl+U)\" />\r\n                <BlockButton format=\"heading-one\" icon=\"gridicons:heading-h1\" alt=\"Heading 1 (Ctrl+Alt+1)\" />\r\n                <BlockButton format=\"heading-two\" icon=\"gridicons:heading-h2\" alt=\"Heading 2 (Ctrl+Alt+2)\" />\r\n                <BlockButton format=\"heading-three\" icon=\"gridicons:heading-h3\" alt=\"Heading 3 (Ctrl+Alt+3)\" />\r\n                <BlockButton format=\"heading-four\" icon=\"gridicons:heading-h4\" alt=\"Heading 4 (Ctrl+Alt+4)\" />\r\n                <ListButton format=\"bulleted-list\" icon=\"ic:baseline-format-list-bulleted\" alt=\"Bulleted list (Ctrl+.)\" />\r\n                <ListButton format=\"numbered-list\" icon=\"ic:baseline-format-list-numbered\" alt=\"Numbered list (Ctrl+/)\" />\r\n                <FunctionButton fn={indentListItem} icon=\"bx:bx-right-indent\" alt=\"Indent list item (Tab)\" />\r\n                <FunctionButton fn={dedentListItem} icon=\"bx:bx-left-indent\" alt=\"Dedent list item (Shift-Tab)\" />\r\n                <FunctionButton fn={(editor: Editor) => insertTemplateBlock(editor, {})} icon=\"uil:brackets-curly\" alt=\"Insert a template block (type in {{)\" />\r\n                <FunctionButton fn={toClipboardMD} icon=\"ion:copy-outline\" alt=\"Copy to clipboard as plain text (Markdown)\" />\r\n                <FunctionButton fn={toClipboardHTML} icon=\"ion:copy\" alt=\"Copy to clipboard as rich text\" />\r\n                <FunctionButton fn={exportTemplateAsFile} icon=\"bx:bxs-download\" alt=\"Save current template/contents as file\" />\r\n                <FunctionButton fn={loadTemplateFromFile} icon=\"ic:baseline-file-upload\" alt=\"Open a template/document from a file\" />\r\n            </Toolbar>\r\n            <SimpleBar className=\"editor\">\r\n                <Editable\r\n                    renderElement={renderElement}\r\n                    renderLeaf={renderLeaf}\r\n                    placeholder=\"Enter some text...\"\r\n                    spellCheck\r\n                    autoFocus\r\n                    onKeyDown={e => {\r\n                        // console.log(Editor.node(editor, editor.selection))\r\n                        listKeyDown(editor)(e)\r\n                        hotkeyHandler(e, editor)\r\n                    }}\r\n                    onSelect={e => {\r\n                        // thanks:\r\n                        // https://github.com/ianstormtaylor/slate/issues/3750\r\n                        if (!(window as any).chrome)\r\n                            return\r\n                        if (editor.selection == null)\r\n                            return\r\n                        \r\n                        try {\r\n                            const domPoint = ReactEditor.toDOMPoint(\r\n                                editor,\r\n                                editor.selection.focus\r\n                            )\r\n                            const node = domPoint[0];\r\n                            if (node == null) return;\r\n                            const element = node.parentElement;\r\n                            if (element == null) return;\r\n                            element.scrollIntoView({behavior: \"smooth\", block: 'nearest'})\r\n                        } catch (e) {\r\n\r\n                        }\r\n                    }}\r\n                />\r\n            </SimpleBar>\r\n        </Slate>\r\n    )\r\n}\r\n","import { Editor, Element as SlateElement } from \"slate\";\r\n\r\nexport const withVoids = (editor: Editor): Editor => {\r\n    const { isInline, isVoid } = editor;\r\n    const voidElementNames = [\"template-block\"]\r\n\r\n    editor.isInline = (element: SlateElement) => {\r\n        let elemType = element.type as string;\r\n        return voidElementNames.includes(elemType) ? true : isInline(element);\r\n    }\r\n\r\n    editor.isVoid = (element: SlateElement) => {\r\n        let elemType = element.type as string;\r\n        return voidElementNames.includes(elemType) ? true : isVoid(element);\r\n    }\r\n    \r\n    return editor;\r\n}","import { Editor } from 'slate';\r\nimport { isHotkey } from 'is-hotkey';\r\n\r\nimport { HOTKEYS, BLOCK_HOTKEYS, FUNCTION_HOTKEYS, LIST_TYPES } from './consts';\r\nimport { toggleMark, toggleBlock } from './utils'\r\nimport { toggleListBlock } from './lists';\r\n\r\nexport const hotkeyHandler = (event: any, editor: Editor) => {\r\n    for (const hotkey in HOTKEYS) {\r\n        if (isHotkey(hotkey, event)) {\r\n            event.preventDefault()\r\n            const mark = HOTKEYS[hotkey]\r\n            toggleMark(editor, mark)\r\n        }\r\n    }\r\n    for (const hotkey in BLOCK_HOTKEYS) {\r\n        if (isHotkey(hotkey, event)) {\r\n            event.preventDefault()\r\n            const block = BLOCK_HOTKEYS[hotkey]\r\n            // todo: modify this function.\r\n            // if something is toggled to a list but it's just before or after another one,\r\n            // it should be merged with it as a bullet point\r\n            if (LIST_TYPES.includes(block)) {\r\n                switch (block) {\r\n                    case \"bulleted-list\":\r\n                        toggleListBlock(editor, \"bulleted-list\")\r\n                        break;\r\n                    case \"numbered-list\":\r\n                        toggleListBlock(editor, \"numbered-list\")\r\n                        break;\r\n                }\r\n            }\r\n            else\r\n                toggleBlock(editor, block)\r\n        }\r\n    }\r\n    for (const hotkey in FUNCTION_HOTKEYS) {\r\n        if (isHotkey(hotkey, event)) {\r\n            event.preventDefault()\r\n            const fn = FUNCTION_HOTKEYS[hotkey]\r\n            fn(editor)\r\n        }\r\n    }\r\n}\r\n","import React, { useState } from 'react';\nimport Modal from \"react-modal\";\nimport \"./css/App.css\"\nimport logo from \"./running.svg\"\n\nimport { RichTextEditor } from './components/RichTextEditor';\nimport { InlineIcon } from '@iconify/react-with-api';\n// fastDischarge should also be able to expose API endpoints where it receives parameters for certain values in a template\n\nfunction App() {\n  const [modalOpen, setModalOpen] = useState(false);\n\n  return (\n    <div className=\"App\">\n      <header>\n        <h1>\n          <img src={logo} alt=\"Running man\" style={{height: \"1em\", display: \"inline-block\", transform: \"translateY(6px)\"}} />\n          FastDischarge\n        </h1>\n      </header>\n      <div className=\"editor-container\">\n        <RichTextEditor />\n      </div>\n      <footer>\n        <div className=\"oneline\">\n          <p>&copy; <a href=\"https://github.com/newageoflight\">Christopher Chen</a> 2021-</p>\n          <button onClick={() => setModalOpen(true)}>\n            <InlineIcon icon=\"bx:bx-help-circle\" />\n          </button>\n        </div>\n      </footer>\n      <Modal isOpen={modalOpen} onRequestClose={() => setModalOpen(false)} contentLabel=\"About FastDischarge\">\n        <div className=\"modal-header\">\n          <h2>About FastDischarge</h2>\n          <button onClick={() => setModalOpen(false)}><InlineIcon icon=\"eva:close-fill\" /></button>\n        </div>\n        <div className=\"modal-body\">\n          <p>FastDischarge aims to be an open-source medical documentation platform that is truly <em>fast</em>.</p>\n          <p>\n            With FastDischarge, you can easily create template fields and prepopulate them with commonly used values of your choice.\n            FastDischarge lets you write your progress notes and discharge letters faster, so you can get back to doctoring.\n          </p>\n          <p>FastDischarge doesn't use any central servers; everything you enter into it is stored locally on your device, so there are no data privacy issues to worry about! (Don't believe me? Check the source code on <a href=\"https://github.com/newageoflight/fast-discharge\">Github</a>!)</p>\n          <h3>Usage guide</h3>\n          <p>To <strong>create a template field</strong>, type <kbd>{\"{{\"}</kbd> into the editor or press the <InlineIcon icon=\"uil:brackets-curly\" /> button in the toolbar.</p>\n          <p><strong>Set your template options</strong> by clicking on the dropdown menu and typing in some text.</p>\n          <p><strong>Cycle to the next template field</strong> by pressing <kbd>TAB</kbd>; <strong>cycle to the previous template field</strong> by pressing <kbd>Shift+TAB</kbd></p>\n          <p>To finalise your document and <strong>copy its contents as plain text</strong> (e.g. Web DeLacy), press the <InlineIcon icon=\"ion:copy-outline\" /> button in the toolbar.</p>\n          <p>To finalise your document and <strong>copy its contents as rich text</strong> (e.g. PowerChart), press the <InlineIcon icon=\"ion:copy\" /> button in the toolbar.</p>\n        </div>\n        <div className=\"modal-footer\">\n          <h3>Contributing/credits</h3>\n          <p>\n            If you have experience working with Slate.js, React.js or Typescript, please consider contributing to this project on <a href=\"https://github.com/newageoflight/fast-discharge\">Github</a>.\n          </p>\n          <p>Developed by <a href=\"mailto:camint3rnal@live.com\">Christopher Chen</a> (JMO/Intern)</p>\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}