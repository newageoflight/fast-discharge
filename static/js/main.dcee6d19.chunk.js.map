{"version":3,"sources":["editor/newPlugins/TemplateBlocks/components/BaseTemplate.tsx","editor/newPlugins/TemplateBlocks/components/VoidTemplate.tsx","editor/newPlugins/TemplateBlocks/components/ListTemplate.tsx","editor/newPlugins/TemplateBlocks/components/DateTemplate.tsx","editor/newPlugins/TemplateBlocks/components/NumberTemplate.tsx","editor/newPlugins/TemplateBlocks/interfaces/Templates.ts","context/EditorContent.ts","components/OneLine.tsx","components/FancyButton.tsx","editor/newPlugins/TemplateBlocks/components/CodeTemplate.tsx","editor/newPlugins/TemplateBlocks/RenderTemplates.tsx","editor/newPlugins/TemplateBlocks/transforms/NavigateTemplates.ts","editor/newPlugins/TemplateBlocks/TemplateBlocksPlugin.ts","editor/rewrittenPlugins/HeadingPlugin.ts","editor/config.ts","editor/rewrittenPlugins/ListPlugin.ts","editor/utils/matches.ts","editor/newPlugins/TemplateBlocks/transforms/InsertTemplateBlock.ts","editor/newPlugins/FragmentInserter/components/Portal.tsx","editor/newPlugins/FragmentInserter/components/FragmentInserterMenu.tsx","editor/newPlugins/FragmentInserter/useFragmentInserter.tsx","context/DotAbbrevs.ts","editor/utils/serialise.ts","components/FunctionButtonsContainer.tsx","utils/fileHandling.ts","context/InitialState.ts","editor/newPlugins/FragmentInserter/components/FragmentInserterPopup.tsx","components/TextEditor.tsx","editor/newPlugins/TemplateBlocks/useTemplates.tsx","components/EditorContainer.tsx","components/HelpModalContent.tsx","App.tsx","dischargeicon.png","reportWebVitals.ts","index.tsx"],"names":["BaseTemplate","renderProps","renderChildren","attributes","children","element","tabIndex","selected","canOverwrite","onKeyDown","useSelected","focused","useFocused","editor","useEditor","useState","name","setName","editName","setEditName","onTop","setOnTop","handleNameChange","useCallback","evt","newName","target","value","changeProps","props","path","ReactEditor","findPath","newProps","Transforms","setNodes","at","defaultStyles","boxShadow","transform","transition","TemplateSpan","contentEditable","style","position","zIndex","className","placeholder","onInput","e","key","onClick","icon","styled","span","VoidTemplate","ListTemplate","isMulti","templateType","defaultValue","chosenValue","setChosenValue","opts","options","setOptions","selectRef","useRef","handleChange","newValue","actionMeta","setMenuOpen","ref","styles","customSelectStyles","theme","customSelectTheme","onChange","onCreateOption","inputValue","newOption","createOption","newSetOption","handleCreate","onMenuOpen","onMenuClose","label","control","provided","state","minHeight","height","paddingTop","valueContainer","currentOptions","getValue","optionsLength","map","opt","length","reduce","a","b","margin","width","selectProps","minWidth","input","indicatorSeparator","display","indicatorsContainer","menu","marginTop","menuIsOpen","multiValue","marginRight","multiValueLabel","padding","option","noOptionsMessage","borderRadius","spacing","baseUnit","DateTemplate","safeDate","Date","chosenDate","setChosenDate","todayButton","date","modifyDate","isClearable","placeholderText","dateFormat","onCalendarOpen","onCalendarClose","NumberTemplate","setValue","asString","toString","type","event","modifyValue","valueAsNumber","legalVariableTypes","EditorState","localStorage","getItem","EditorVariablesState","atom","default","JSON","parse","OneLine","div","FancyButton","button","main","CodeTemplate","editing","setEditing","expr","result","setResult","variables","useRecoilValue","elemProps","useEffect","newResult","usableVariables","Object","fromEntries","entries","nunjucks","renderString","helperFunctions","error","toChange","currentTarget","dateDifference","unit","dayjs","diff","renderTemplates","isTemplateBlock","Editor","node","thisNode","parent","Text","isText","templateElementTypes","resetBlockTypesCommonRule","types","defaultType","plugins","ParagraphPlugin","h1","hotkey","h2","h3","h4","h5","h6","levels","renderElement","renderElementHeading","deserialize","deserializeHeading","forEach","hotkeys","Array","isArray","undefined","isHotkey","preventDefault","toggleNodeType","activeType","inactiveType","renderElementList","deserializeList","keys","includes","ol","toggleList","typeList","ul","onKeyDownList","ListPlugin","BoldPlugin","ItalicPlugin","UnderlinePlugin","SubscriptPlugin","subscript","SuperscriptPlugin","superscript","ResetBlockTypePlugin","rules","predicate","isBlockAboveEmpty","isSelectionAtBlockStart","SoftBreakPlugin","query","allow","ExitBreakPlugin","level","before","start","end","inlineTypes","voidTypes","lastTemplateNodeEntry","referencePoint","selection","startPoint","first","searchSpan","nodeIterator","nodes","reverse","match","mode","voids","previous","lastTemplatePath","select","findPreviousTemplate","nextTemplateNodeEntry","last","next","nextTemplatePath","findNextTemplate","withPlugins","withReact","withHistory","withInlineVoid","withList","matchBefore","beforeOpts","rangeEnd","beforeRange","range","beforeText","string","beforeMatch","text","insertTemplateBlock","templateBlock","insertNodes","move","Portal","ReactDOM","createPortal","document","body","FragmentInserterMenu","pos","onClickItem","useSlate","el","current","rect","toDOMRange","getBoundingClientRect","top","window","pageYOffset","left","pageXOffset","HangingMenu","i","optVal","active","description","SelectItem","onMouseDown","useFragmentInserter","abbrevs","setTarget","index","setIndex","search","setSearch","searchedAbbrevs","filter","toLowerCase","startsWith","onInsertFragment","data","insertFragment","onKeyDownFragmentInserter","prevIndex","nextIndex","keyToGet","fragmentToInsert","onChangeFragmentInserter","Range","isCollapsed","beforeWordRange","beforeWordMatch","edges","wordBefore","wordBeforeMatch","afterMatch","afterOpts","after","afterRange","afterText","matchAfter","existingAbbrevs","DotAbbrevsState","toClipboardMD","navigator","clipboard","writeText","preprocessed","preprocessMDNode","processor","unified","use","slateToRemark","stringify","bullet","ast","runSync","textLines","split","tftBlocks","s","join","matchAll","toRemove","tft","matched","fPos","val","idx","concat","toMarkdown","then","alert","templatesToText","newNode","nodeDate","getDate","getMonth","getFullYear","strong","bold","emphasis","italic","depth","ordered","FunctionButtonsContainer","HorizontalScroller","downloadFile","fileCreator","fileName","blob","fileDownloadURL","URL","createObjectURL","tempLink","createElement","href","setAttribute","click","remove","uploadSingleFile","uploadHandler","acceptExts","fileSelector","v","addEventListener","files","file","fr","FileReader","fileExt","InitialState","FragmentInserterPopup","setComplete","setFragments","lastSelection","useForm","register","handleSubmit","errors","DarkWrapper","PopupMenu","marginBottom","onSubmit","newAbbrevs","fragment","fragmentObject","setItem","FormRow","ErrorSpan","htmlFor","PrettyTextInput","required","pattern","PrettyTextArea","border","backgroundColor","textarea","Modal","setAppElement","TextEditor","startingState","initialValue","useRecoilState","dotAbbrevs","setDotAbbrevs","setTemplateVars","useSetRecoilState","settingsOpen","setSettingsOpen","createSnippet","setCreateSnippet","setLastSelection","useMemo","pipe","createEditor","onChangeTemplates","insertTemplate","setInsertTemplate","replaceText","setReplaceText","distance","focusActiveTemplate","currentPath","activeInput","Path","console","log","useTemplates","content","vars","endPoint","templateNodes","findTemplateVariables","root","justifyContent","tooltip","clear","item","Blob","serializeHTMLFromNodes","toClipboardHTML","insertText","readAsText","onload","loaded","onKeyDownDeps","spellCheck","autoFocus","arrow","isOpen","onRequestClose","EditorContainer","HelpModalContent","App","modalOpen","setModalOpen","src","alt","contentLabel","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.dcee6d19.chunk.js","sourcesContent":["import React, { useCallback, useState } from 'react'\r\nimport { Transforms, Editor } from 'slate';\r\nimport { useSelected, useFocused, useEditor, ReactEditor, RenderElementProps } from 'slate-react';\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\nimport AutoSizeInput from \"react-input-autosize\";\r\nimport styled from \"styled-components\";\r\n\r\nimport { TemplateBlockProps } from \"../interfaces/Templates\"\r\n\r\n// base type for all templates\r\n// should have:\r\n// - a gear icon for naming the block\r\n// - an input area, whether that be select, date, link, blank or otherwise\r\n// the point of this is just to be a generic type that can hold whatever arbitrary input you like\r\n// what should the base type provide to the child it contains?\r\n// - onTop and setOnTop\r\n// - name\r\n// - element\r\n// - editor (maybe)\r\n\r\ninterface TemplatePassProps {\r\n    onTop: boolean;\r\n    setOnTop: React.Dispatch<React.SetStateAction<boolean>>;\r\n    name: string;\r\n    editor: Editor;\r\n    changeProps: (props: TemplateBlockProps) => void;\r\n    selected: boolean;\r\n    focused: boolean;\r\n}\r\n\r\nexport interface TemplateBaseProps {\r\n    renderProps: RenderElementProps;\r\n    children: (templateProps: TemplatePassProps) => React.ReactElement;\r\n    tabIndex?: number;\r\n    canOverwrite?: boolean;\r\n    onKeyDown?: React.KeyboardEventHandler;\r\n}\r\n\r\nexport interface TemplateElementProps {\r\n    renderProps: RenderElementProps;\r\n    templateProps: TemplatePassProps;\r\n}\r\n\r\nexport const BaseTemplate: React.FC<TemplateBaseProps> = ({ renderProps: {attributes, children: renderChildren, element}, children, tabIndex, canOverwrite, onKeyDown }) => {\r\n    const selected = useSelected();\r\n    const focused = useFocused();\r\n    const editor = useEditor();\r\n    \r\n    const [name, setName] = useState<string>((element.name as string))\r\n    const [editName, setEditName] = useState(false);\r\n    \r\n    const [onTop, setOnTop] = useState(false);\r\n\r\n    const handleNameChange = useCallback((evt: React.FormEvent) => {\r\n        let newName = (evt.target as HTMLInputElement).value\r\n        setName(newName);\r\n        changeProps({name: newName})\r\n        // eslint-disable-next-line\r\n    }, [setName])\r\n    \r\n    const changeProps = useCallback((props: TemplateBlockProps) => {\r\n        let path = ReactEditor.findPath(editor, element)\r\n        let newProps = {...props}\r\n        Transforms.setNodes(editor, newProps, {at:path})\r\n        // eslint-disable-next-line\r\n    }, [element])\r\n    \r\n    // const overWrite = (evt: React.KeyboardEvent) => {\r\n    //     let path = ReactEditor.findPath(editor, element)\r\n    //     if (evt.key.length === 1 && !editName) {\r\n    //         let currentNode = Editor.node(editor, path)\r\n    //         let newNode = {text: `${evt.key}`}\r\n    //         // set the node's props as follows\r\n    //         Transforms.setNodes(editor, newNode)\r\n    //         console.log(evt.key)\r\n    //         console.log(path, editor.children, Editor.node(editor, path))\r\n    //         Transforms.removeNodes(editor, {at: path, voids: true})\r\n    //         Transforms.insertText(editor, evt.key, {at: path, voids: true})\r\n    //         Transforms.select(editor, path)\r\n    //         console.log(path, editor.children, Editor.node(editor, path))\r\n    //         console.log(\"Should overwrite this node with whatever you typed or pasted\")\r\n    //     }\r\n    // }\r\n    \r\n    // this fix using the onmenuclose and onmenuopen hooks seems to work, but i'm not sure how safe it is\r\n    const defaultStyles: React.CSSProperties = {\r\n        boxShadow: selected && focused ? '0 0 0 2px #b4d5ff' : 'none',\r\n        transform: `translateY(${editName ? 0 : 2}px)`,\r\n        transition: \"0.3s ease all\"\r\n    }\r\n\r\n    const focusedStyles: React.CSSProperties = {\r\n        position: \"relative\",\r\n        zIndex: 99\r\n    }\r\n\r\n    return (\r\n        <TemplateSpan\r\n            contentEditable={false}\r\n            tabIndex={tabIndex}\r\n            // onKeyDown={canOverwrite ? overWrite : undefined}\r\n            style={onTop ? {...defaultStyles, ...focusedStyles} : defaultStyles}>\r\n            {editName ?\r\n            (\r\n                <div className=\"content\">\r\n                    <AutoSizeInput placeholder=\"Name this field...\" value={name} onInput={handleNameChange} onKeyDown={e => e.key === \"Enter\" && setEditName(!editName)} />\r\n                </div>\r\n            )\r\n            : children({onTop, setOnTop, name, editor, changeProps, selected, focused})}\r\n            <button className=\"name-setter\"\r\n                onClick={() => {\r\n                    setEditName(!editName)\r\n                }}\r\n                tabIndex={-1}\r\n            ><InlineIcon icon=\"bi:gear-fill\" /></button>\r\n            {renderChildren}\r\n        </TemplateSpan>\r\n    )\r\n}\r\n\r\nconst TemplateSpan = styled.span`\r\n    padding: 3px 3px 2px; \r\n    margin: 0 1px;\r\n    vertical-align: baseline;\r\n    display: inline-flex;\r\n    flex-direction: row;\r\n    border-radius: 4px;\r\n    background-color: #eee;\r\n    font-size: 0.9rem;\r\n    \r\n    > div:first-child {\r\n        flex: 1 1 auto;\r\n        flex-basis: inherit;\r\n        \r\n        > input[type=text] {\r\n            width: 90%;\r\n        }\r\n    }\r\n    \r\n    > button.name-setter {\r\n        display: inline-block;\r\n        border: none;\r\n        border-radius: 5px;\r\n        outline: none;\r\n        transition: 0.3s ease all;\r\n        \r\n        &:focus {\r\n            box-shadow: 0 0 0 2px #b4d5ff; \r\n        }\r\n    }\r\n`","import React from 'react'\r\nimport { RenderElementProps } from 'slate-react';\r\n\r\nimport { BaseTemplate } from './BaseTemplate';\r\n\r\n// generic void template similar to wildcards in EPIC or PowerChart, only purpose is to be overtyped\r\n\r\nexport const VoidTemplate: React.FC<RenderElementProps> = ({ attributes, element, children }) => {\r\n    return (\r\n        <BaseTemplate renderProps={{attributes, element, children}} tabIndex={0} canOverwrite={true}>\r\n            {({ name }) => <>{name || \"(void)\"}</>}\r\n        </BaseTemplate>\r\n    )\r\n}\r\n","import React, { useCallback, useRef, useState } from 'react'\r\nimport CreatableSelect from 'react-select/creatable'\r\nimport { ValueType } from 'react-select';\r\nimport { RenderElementProps } from 'slate-react';\r\n\r\nimport { BaseTemplate } from './BaseTemplate';\r\nimport { TemplateBlockProps } from '../interfaces/Templates';\r\n\r\n// this template should be an inline editable element that also allows you to:\r\n// - set options\r\n// - expand to arbitrary slate json\r\n// insert using {{\r\ntype OptionType = {\r\n    label: string,\r\n    value: string\r\n}\r\n\r\n// TODO: add the ability to set the options while the template block is focused/selected\r\nexport const ListTemplate: React.FC<RenderElementProps> = ({ attributes, element, children }) => {\r\n    const isMulti = element.templateType === \"multiselect\"\r\n    const [chosenValue, setChosenValue] = useState<ValueType<OptionType,false>|ValueType<OptionType,false>[]>(element.defaultValue ? (element.defaultValue as {label:string,value:string}) : null as ValueType<{label:string,value:string}, false>);\r\n    const [options, setOptions] = useState<OptionType[]>(element.opts ? element.opts as OptionType[] : [])\r\n    const selectRef = useRef<any>(null);\r\n\r\n    const handleChange = useCallback((newValue: any, actionMeta: any, changeProps: (props: TemplateBlockProps) => void) => {\r\n        setChosenValue(newValue);\r\n        changeProps({defaultValue: newValue})\r\n        // eslint-disable-next-line\r\n    }, [setChosenValue])\r\n    \r\n    const handleCreate = (inputValue: any, changeProps: (props: TemplateBlockProps) => void) => {\r\n        const newOption = createOption(inputValue);\r\n        const newSetOption = isMulti ? [...((element.defaultValue ? element.defaultValue : []) as OptionType[]), newOption] : newOption\r\n        setOptions([...options, newOption])\r\n        setChosenValue(newSetOption);\r\n        changeProps({opts: [...options, newOption], defaultValue: newSetOption})\r\n    }\r\n    \r\n    return (\r\n        <BaseTemplate renderProps={{attributes, element, children}}>\r\n            {\r\n            ({ name, setOnTop: setMenuOpen, changeProps }) =>\r\n                (<CreatableSelect isMulti={isMulti}\r\n                    ref={selectRef}\r\n                    tabIndex={`0`}\r\n                    styles={customSelectStyles} theme={customSelectTheme}\r\n                    placeholder={name || (isMulti ? \"Select many...\" : \"Select...\")}\r\n                    onChange={(newValue: any, actionMeta: any) => handleChange(newValue, actionMeta, changeProps)}\r\n                    onCreateOption={(inputValue: any) => handleCreate(inputValue, changeProps)}\r\n                    onMenuOpen={() => setMenuOpen(true)} onMenuClose={() => setMenuOpen(false)}\r\n                    value={chosenValue} options={options} />)\r\n            }\r\n        </BaseTemplate>\r\n    )\r\n}\r\n\r\nconst createOption = (label: string) => ({\r\n    label,\r\n    value: label\r\n})\r\n\r\n// auto width: https://stackoverflow.com/questions/46571811/react-select-auto-size-width\r\n// modify height: https://stackoverflow.com/questions/54218351/changing-height-of-react-select-component\r\nconst customSelectStyles = {\r\n    control: (provided: any, state: any) => ({\r\n        ...provided,\r\n        minHeight: \"1.4em\",\r\n        height: \"1.5em\",\r\n        paddingTop: \"1px\",\r\n    }),\r\n    valueContainer: (provided: any, state: any) => {\r\n        // this doesn't work for multis so should be something else if multi\r\n        let { isMulti } = state;\r\n        let currentOptions = (state.getValue() as OptionType[]);\r\n        let optionsLength = currentOptions.map(opt => opt.label.length).reduce((a,b) => a+b+(isMulti ? 3 : 2), 0) - 2 + (isMulti ? 3 : 0)\r\n        return ({\r\n            ...provided,\r\n            margin: \"0 0 0 4px\",\r\n            transform: \"translateY(-2.2px)\",\r\n            width: `${(currentOptions.length > 0 ? optionsLength :\r\n                state.selectProps.placeholder ? state.selectProps.placeholder.length : 5) + 2}ex`,\r\n            minWidth: \"5ex\",\r\n        })\r\n    },\r\n    input: (provided: any, state: any) => ({\r\n        ...provided,\r\n        margin: \"0px\",\r\n    }),\r\n    indicatorSeparator: (state: any) => ({\r\n        display: 'none',\r\n    }),\r\n    indicatorsContainer: (provided: any, state: any) => ({\r\n        ...provided,\r\n        height: '1.5em',\r\n        transform: \"translateY(-2px)\"\r\n    }),\r\n    menu: (provided: any, state: any) => ({\r\n        ...provided,\r\n        marginTop: 0,\r\n        zIndex: `${state.selectProps.menuIsOpen ? 999 : \"inherit\"}`\r\n    }),\r\n    multiValue: (provided: any, state: any) => ({\r\n        ...provided,\r\n        marginRight: \"3px\",\r\n    }),\r\n    multiValueLabel: (provided: any) => ({\r\n        ...provided,\r\n        padding: 0,\r\n    }),\r\n    option: (provided: any) => ({\r\n        ...provided,\r\n        padding: \"5px\",\r\n    }),\r\n    noOptionsMessage: (provided: any) => ({\r\n        ...provided,\r\n        padding: \"5px 0\",\r\n    }),\r\n}\r\n\r\nconst customSelectTheme = (theme: any) => ({\r\n    ...theme,\r\n    borderRadius: 0,\r\n    spacing: {\r\n        ...theme.spacing,\r\n        baseUnit: 0,\r\n    },\r\n})","import React, { useState } from 'react'\r\nimport { RenderElementProps } from 'slate-react'\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\n\r\nimport { BaseTemplate } from './BaseTemplate';\r\nimport { TemplateBlockProps } from '../interfaces/Templates';\r\n\r\n// should be a span with a button that allows you to pick a date. insert using @@\r\n\r\nexport const DateTemplate: React.FC<RenderElementProps> = ({ attributes, children, element }) => {\r\n    let safeDate;\r\n    if (element.defaultValue instanceof Date) {\r\n        safeDate = element.defaultValue\r\n    } else if (typeof element.defaultValue === \"string\") {\r\n        safeDate = new Date(element.defaultValue);\r\n    }\r\n    const [chosenDate, setChosenDate] = useState(safeDate || new Date());\r\n\r\n    const modifyDate = (date: Date, changeProps: (props: TemplateBlockProps) => void) => {\r\n        setChosenDate(date);\r\n        changeProps({defaultValue: date})\r\n    }\r\n\r\n    // set the element's defaultValue to today by default\r\n\r\n    return (\r\n        <BaseTemplate renderProps={{attributes, element, children}}>\r\n            {({ name, changeProps, setOnTop }) => {\r\n                return <DatePicker todayButton=\"Today\" selected={chosenDate} onChange={(date: Date) => modifyDate(date, changeProps)}\r\n                    isClearable placeholderText={name} dateFormat=\"dd/MM/yyyy\"\r\n                    onCalendarOpen={() => setOnTop(true)} onCalendarClose={() => setOnTop(false)} />\r\n            }\r\n            }\r\n        </BaseTemplate>\r\n    )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { RenderElementProps } from 'slate-react'\r\nimport { BaseTemplate } from './BaseTemplate';\r\nimport { TemplateBlockProps } from './../interfaces/Templates';\r\n\r\nexport const NumberTemplate: React.FC<RenderElementProps> = ({attributes, element, children}) => {\r\n    const [value, setValue] = useState<number>((element.defaultValue as number));\r\n\r\n    const modifyValue = (value: number, changeProps: (props: TemplateBlockProps) => void) => {\r\n        setValue(value);\r\n        changeProps({defaultValue: value})\r\n    }\r\n    \r\n    const asString = (value: number | undefined): string => {\r\n        if (value == null)\r\n            return ''\r\n        else\r\n            return value.toString()\r\n    }\r\n\r\n    return (\r\n        <BaseTemplate renderProps={{attributes, element, children}}>\r\n            {({name, changeProps}) => <input type=\"number\" value={value} onChange={event => modifyValue(event.target.valueAsNumber, changeProps)}\r\n                placeholder={name || \"(number)\"}\r\n                style={{\r\n                width: `${(value ? asString(value).length : name ? name.length : 8) + 3}ex`\r\n            }}/>}\r\n        </BaseTemplate>\r\n    )\r\n}\r\n","// all in all, a template block can be:\r\n// - void: contains nothing, only can be overtyped\r\n// - date: holds a datetime. uses a datepicker to select\r\n// - select: the default type, holds string options\r\n// - multiselect: can join multiple string options together\r\n// - ref: dynamic links or simple values provided through an addon\r\n// - expr: a nunjucks expression that is dependent on other variables in the scope of the template\r\n// - wiz: a \"wizard\" - essentially invokes a form that links to blocks that will be inserted in place of the template\r\n//   depending on what values are entered in the form\r\n\r\nimport { Element, Editor, Text } from \"slate\";\r\n\r\nexport type OptionType = {\r\n    label: string,\r\n    value: string\r\n}\r\n\r\nexport interface TemplateBlockProps {\r\n    name?: string;\r\n    canOvertype?: boolean;\r\n    templateType?: \"void\" | \"date\" | \"select\" | \"multiselect\" | \"ref\" | \"expr\" | \"wiz\" | \"number\";\r\n    opts?: OptionType[];\r\n    defaultValue?: OptionType | OptionType[] | Date | string | number;\r\n    activeInput?: boolean;\r\n    expr?: string;\r\n}\r\n\r\nexport interface TemplateBlockTextProps extends TemplateBlockProps, Text {};\r\nexport interface TemplateBlockElementProps extends TemplateBlockProps, Element {};\r\nexport interface TemplateBlockEditorProps extends TemplateBlockProps, Editor {};\r\n\r\nexport type TemplateBlockNode = TemplateBlockTextProps | TemplateBlockElementProps | TemplateBlockEditorProps;\r\n\r\n// template variables cannot be voids, refs, expressions or wizards\r\nexport const legalVariableTypes: Array<TemplateVariable[\"templateType\"] | string> = [\"date\", \"select\", \"multiselect\", \"ref\", \"expr\", \"wiz\", \"number\"]\r\nexport interface TemplateVariable {\r\n    templateType: \"date\" | \"select\" | \"multiselect\" | \"ref\" | \"expr\" | \"wiz\" | \"number\";\r\n    value: Date | number | string | string[];\r\n}","import { atom } from 'recoil';\r\nimport { SlateDocument } from '@udecode/slate-plugins';\r\nimport { Editor, Node, Path } from 'slate';\r\nimport { OptionType, legalVariableTypes, TemplateBlockNode, TemplateVariable } from '../editor/newPlugins/TemplateBlocks/interfaces/Templates';\r\nimport { nanoid } from 'nanoid';\r\n\r\nconst EditorState = localStorage.getItem(\"content\")\r\n\r\nexport const EditorContentState = atom<SlateDocument>({\r\n    key: \"EditorState\",\r\n    default: EditorState ? JSON.parse(EditorState) : {}\r\n})\r\n\r\nexport const EditorVariablesState = atom<Record<string, TemplateVariable>>({\r\n    key: \"EditorVariables\",\r\n    default: {}\r\n})\r\n\r\n// this should only run when the editor initialises\r\nexport const findTemplateVariables = (editor: Editor): Record<string, TemplateVariable> => {\r\n    const [,startPoint] = Editor.first(editor, [])\r\n    const [,endPoint] = Editor.last(editor, [])\r\n    // console.log([startPoint, endPoint])\r\n    let templateNodes = Editor.nodes(editor, { at: [startPoint, endPoint] , match: (node: Node) => node.type === \"template-block\", voids: true, mode: \"lowest\" })\r\n    // store the name, type and content of each block in the variables state atom\r\n    // these can then be used to perform calculations etc.\r\n    let variables = {} as Record<string, TemplateVariable>\r\n    for (let entry of templateNodes) {\r\n        // console.log(entry)\r\n        let [node] = entry as [node: TemplateBlockNode, path: Path];\r\n        if (node.type === \"template-block\") {\r\n            node = node as TemplateBlockNode;\r\n            if (node.templateType && legalVariableTypes.includes(node.templateType)) {\r\n                // typecasting\r\n                let val;\r\n                if (node.defaultValue != null) {\r\n                    switch (node.templateType) {\r\n                        case \"date\":\r\n                            val = (typeof node.defaultValue === \"string\") ? new Date(node.defaultValue) : node.defaultValue as Date;\r\n                            break;\r\n                        case \"number\":\r\n                            val = node.defaultValue as number;\r\n                            break;\r\n                        case \"select\":\r\n                            val = (node.defaultValue as OptionType).value;\r\n                            break;\r\n                        case \"multiselect\":\r\n                            val = (node.defaultValue as OptionType[]).map(opt => opt.value);\r\n                            break;\r\n                        default:\r\n                            val = (node.defaultValue as any);\r\n                            break;\r\n                    }\r\n                }\r\n                if (node.name)\r\n                    variables[(node.name as string)] = {templateType: (node.templateType as TemplateVariable[\"templateType\"]), value: val}\r\n            }\r\n        }\r\n    }\r\n    return variables;\r\n}","import styled from \"styled-components\"\r\n\r\nexport const OneLine = styled.div`\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n`","import styled from 'styled-components';\r\n\r\nexport const FancyButton = styled.button`\r\n    outline: none;\r\n    border: none;\r\n    background-color: transparent;\r\n    height: fit-content;\r\n    padding: ${props => props.theme.main || \"5px\"};\r\n    border-radius: 5px;\r\n    font-size: 1rem;\r\n\r\n    &:hover {\r\n        background-color: #ddd;\r\n    }\r\n\r\n    &:active {\r\n        background-color: #999;\r\n    }\r\n`","import React, { useCallback, useEffect, useState } from 'react'\r\nimport { Transforms } from 'slate';\r\nimport { ReactEditor, RenderElementProps, useEditor } from 'slate-react'\r\nimport { BaseTemplate } from './BaseTemplate'\r\nimport nunjucks from \"nunjucks\";\r\nimport { TemplateBlockProps } from './../interfaces/Templates';\r\nimport { useRecoilValue } from 'recoil';\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\nimport AutosizeInput from 'react-input-autosize';\r\nimport dayjs from \"dayjs\";\r\n\r\nimport { EditorVariablesState } from '../../../../context/EditorContent';\r\nimport { OneLine } from '../../../../components/OneLine';\r\nimport { FancyButton } from '../../../../components/FancyButton';\r\n\r\n// executes arbitrary nunjucks code depending on the value of other named template fields\r\n// useful for conditional fields e.g. use \"he\" if patient is male or \"she\" if patient is female\r\n\r\nexport const CodeTemplate: React.FC<RenderElementProps> = (props) => {\r\n    const editor = useEditor()\r\n    const [editing, setEditing] = useState(false);\r\n    const [value, setValue] = useState<string>((props.element.expr as string))\r\n    const [result, setResult] = useState<any>(props.element.defaultValue);\r\n    const variables = useRecoilValue(EditorVariablesState);\r\n    \r\n    const changeProps = useCallback((elemProps: TemplateBlockProps) => {\r\n        let path = ReactEditor.findPath(editor, props.element)\r\n        let newProps = {...elemProps}\r\n        Transforms.setNodes(editor, newProps, {at:path})\r\n        // eslint-disable-next-line\r\n    }, [props.element])\r\n\r\n    const modifyValue = (toChange: string, changeProps: (props: TemplateBlockProps) => void) => {\r\n        // console.log(toChange, variables)\r\n        setValue(toChange);\r\n        const usableVariables = Object.fromEntries(Object.entries(variables).map(([k, v]) => [k, v.value]))\r\n        // console.log(usableVariables)\r\n        let newResult;\r\n        try {\r\n            newResult = nunjucks.renderString(`{{ ${value} }}`, {...usableVariables, ...helperFunctions})\r\n        } catch (error) {\r\n            newResult = \"~ERROR~\";\r\n        }\r\n        setResult(newResult)\r\n        changeProps({defaultValue: newResult, expr: toChange})\r\n    }\r\n\r\n    useEffect(() => {\r\n        const usableVariables = Object.fromEntries(Object.entries(variables).map(([k, v]) => [k, v.value]))\r\n        let newResult;\r\n        try {\r\n            newResult = nunjucks.renderString(`{{ ${value} }}`, {...usableVariables, ...helperFunctions})\r\n        } catch (error) {\r\n            newResult = \"~ERROR~\";\r\n        }\r\n        setResult(newResult)\r\n        changeProps({defaultValue: newResult})\r\n    }, [variables])\r\n\r\n    return (\r\n        <BaseTemplate renderProps={props}>\r\n            {({ name, changeProps }) => {\r\n                return (\r\n                    <OneLine theme={{main: {padding: 0}}}>\r\n                        {!editing ? (\r\n                            <>\r\n                                <div>\r\n                                    {result || \"(formula)\"}\r\n                                </div>\r\n                            </>\r\n                        ) : (\r\n                            <AutosizeInput placeholder={name} value={value} onChange={(event) => setValue(event.target.value)}\r\n                                onKeyDown={(e) => {\r\n                                    if (e.key === \"Enter\") {\r\n                                       setEditing(false)\r\n                                       modifyValue(e.currentTarget.value, changeProps)\r\n                                    }}} />\r\n                        )}\r\n                        <FancyButton onClick={(e) => setEditing(!editing)} theme={{main: {padding: 0}}}>\r\n                            <InlineIcon icon=\"bx:bxs-pencil\" />\r\n                        </FancyButton>\r\n                    </OneLine>\r\n                )\r\n            }}\r\n        </BaseTemplate>\r\n    )\r\n}\r\n\r\nconst helperFunctions = {\r\n    dateDifference: (a: Date, b: Date, unit?: any) => {\r\n        return dayjs(a).diff(dayjs(b), unit)\r\n    }\r\n}","import { RenderElementProps } from 'slate-react';\r\nimport { VoidTemplate } from './components/VoidTemplate';\r\nimport { ListTemplate } from './components/ListTemplate';\r\nimport { DateTemplate } from './components/DateTemplate';\r\nimport { NumberTemplate } from './components/NumberTemplate';\r\nimport { CodeTemplate } from './components/CodeTemplate';\r\n\r\nexport const renderTemplates = ({attributes, element, children}: RenderElementProps) => {\r\n    if (element.type === \"template-block\") {\r\n        switch ((element.templateType as string)) {\r\n            case \"select\":\r\n                return <ListTemplate attributes={attributes} element={element}>{children}</ListTemplate>\r\n            case \"multiselect\":\r\n                return <ListTemplate attributes={attributes} element={element}>{children}</ListTemplate>\r\n            case \"void\":\r\n                return <VoidTemplate attributes={attributes} element={element}>{children}</VoidTemplate>\r\n            case \"date\":\r\n                return <DateTemplate attributes={attributes} element={element}>{children}</DateTemplate>\r\n            case \"number\":\r\n                return <NumberTemplate attributes={attributes} element={element}>{children}</NumberTemplate>\r\n            case \"expr\":\r\n                return <CodeTemplate attributes={attributes} element={element}>{children}</CodeTemplate>\r\n            default:\r\n                return <VoidTemplate attributes={attributes} element={element}>{children}</VoidTemplate>\r\n        }\r\n    }\r\n}","import { Editor, Node, NodeEntry, Location, Transforms, Path, Span, Text } from 'slate';\r\n\r\n// utility functions for finding and navigating to template blocks in the editor\r\n// actually they kinda work - if you have more than one block present, it will go two blocks back\r\n// however, it will skip over the nearest block for reasons i can't understand at the moment\r\n// also, selecting the template should not just take you to the block but also allow you to select the options\r\n// TODO: fix the selection issues\r\n\r\nexport const findNextTemplate = (editor: Editor, at?: Location): void => {\r\n    let referencePoint = at || editor.selection!\r\n    let [,startPoint] = Editor.node(editor, referencePoint)\r\n    // console.log(startPoint)\r\n    let [,endPoint] = Editor.last(editor, [])\r\n    let searchSpan: Span = [startPoint, endPoint]\r\n    let nodeIterator = Editor.nodes(editor, { at: searchSpan, match: (node: Node) => node.type === \"template-block\", mode: \"lowest\", voids: true })\r\n    // for (let pair of nodeIterator) {\r\n    //     let [node, path] = pair;\r\n    //     console.log(node, path)\r\n    // }\r\n    let nextTemplateNodeEntry;\r\n    if (!isTemplateBlock(editor, startPoint))\r\n        [nextTemplateNodeEntry] = nodeIterator;\r\n    else {\r\n        nextTemplateNodeEntry = (Editor.next(editor, {\r\n            at: referencePoint,\r\n            match: (node: Node) => node.type === \"template-block\",\r\n            mode: 'lowest',\r\n            voids: true\r\n        }) as NodeEntry)\r\n    }\r\n    if (!!nextTemplateNodeEntry) {\r\n        let [,nextTemplatePath] = nextTemplateNodeEntry\r\n        Transforms.select(editor, nextTemplatePath);\r\n    }\r\n}\r\n\r\nexport const findPreviousTemplate = (editor: Editor, at?: Location): void => {\r\n    let referencePoint = at || editor.selection!\r\n    let [,startPoint] = Editor.node(editor, referencePoint)\r\n    // console.log(startPoint)\r\n    let [,endPoint] = Editor.first(editor, [])\r\n    // console.log(endPoint)\r\n    let searchSpan: Span = [startPoint, endPoint]\r\n    // console.log(searchSpan)\r\n    let nodeIterator = Editor.nodes(editor, { reverse: true, at: searchSpan, match: (node: Node) => node.type === \"template-block\", mode: \"lowest\", voids: true })\r\n    // for (let pair of nodeIterator) {\r\n    //     let [node, path] = pair;\r\n    //     console.log(node, path)\r\n    // }\r\n    let lastTemplateNodeEntry\r\n    if (!isTemplateBlock(editor, startPoint))\r\n        [lastTemplateNodeEntry] = nodeIterator;\r\n    else {\r\n        lastTemplateNodeEntry = (Editor.previous(editor, {\r\n            at: referencePoint,\r\n            match: (node: Node) => node.type === \"template-block\",\r\n            mode: 'lowest',\r\n            voids: true\r\n        }) as NodeEntry)\r\n        // console.log(lastTemplateNodeEntry)\r\n    }\r\n    if (!!lastTemplateNodeEntry) {\r\n        let [,lastTemplatePath] = lastTemplateNodeEntry\r\n        Transforms.select(editor, lastTemplatePath)\r\n    }\r\n}\r\n\r\nexport function isTemplateBlock(editor: Editor, at: Location) {\r\n    let [thisNode] = Editor.node(editor, at);\r\n    let [parent] = Editor.parent(editor, at);\r\n    // console.log(thisNode, parent)\r\n    return Text.isText(thisNode) && parent.type === 'template-block'\r\n}","import { Editor } from \"slate\";\r\nimport { SlatePlugin } from \"@udecode/slate-plugins\";\r\n\r\nimport { renderTemplates } from './RenderTemplates';\r\nimport { TemplateBlocksOptions } from './interfaces/Options';\r\nimport { isHotkey } from 'is-hotkey';\r\nimport { findPreviousTemplate, findNextTemplate } from \"./transforms/NavigateTemplates\";\r\n\r\n// read over these before you get into the refactoring:\r\n// https://slate-plugins-next.netlify.app/?path=/story/elements-mention--example\r\n// https://github.com/udecode/slate-plugins/tree/e29baf6a90d52692a0ddd9f49cf2668fabe0b873/packages/slate-plugins/src/elements/mention\r\n\r\nconst templateElementTypes = [\"template-block\"]\r\n\r\nexport const TemplateBlocksPlugin = (options?: TemplateBlocksOptions): SlatePlugin => ({\r\n    renderElement: renderTemplates,\r\n    inlineTypes: templateElementTypes,\r\n    voidTypes: templateElementTypes,\r\n    onKeyDown: (e: KeyboardEvent, editor: Editor) => {\r\n        if (isHotkey(\"mod+[\", e))\r\n            findPreviousTemplate(editor)\r\n        if (isHotkey(\"mod+]\", e))\r\n            findNextTemplate(editor)\r\n    }\r\n})\r\n","import { deserializeHeading, HeadingPluginOptions, HeadingPluginOptionsValues, renderElementHeading, SlatePlugin, toggleNodeType } from \"@udecode/slate-plugins\";\r\nimport isHotkey from \"is-hotkey\";\r\n\r\nexport const HeadingPlugin = (options?: HeadingPluginOptions): SlatePlugin => ({\r\n    renderElement: renderElementHeading(options),\r\n    deserialize: deserializeHeading(options),\r\n    onKeyDown: (e, editor) => {\r\n        options && Object.entries(options).forEach(([k, v]) => {\r\n            let { type, defaultType, hotkey } = (v as HeadingPluginOptionsValues);\r\n            const hotkeys = (Array.isArray(hotkey)) ? hotkey : !!hotkey ? [hotkey] : undefined\r\n            if (hotkeys) {\r\n                for (let key of hotkeys) {\r\n                    if (isHotkey(key, e)) {\r\n                        e.preventDefault();\r\n                        toggleNodeType(editor, { activeType: type!, inactiveType: defaultType })\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n})\r\n","import { BoldPlugin, ExitBreakPlugin, ItalicPlugin, ParagraphPlugin, SoftBreakPlugin, UnderlinePlugin, withList, ResetBlockTypePlugin, isBlockAboveEmpty, isSelectionAtBlockStart, SubscriptPlugin, SuperscriptPlugin, withInlineVoid } from \"@udecode/slate-plugins\";\r\nimport { withHistory } from \"slate-history\";\r\nimport { withReact } from 'slate-react';\r\nimport { TemplateBlocksPlugin } from \"./newPlugins/TemplateBlocks/TemplateBlocksPlugin\";\r\n\r\nimport { HeadingPlugin } from './rewrittenPlugins/HeadingPlugin';\r\nimport { ListPlugin } from './rewrittenPlugins/ListPlugin';\r\n\r\nexport const HEADING_ELEMENTS = [\"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\"]\r\n\r\nexport const resetBlockTypesCommonRule = {\r\n    types: [\"bold\", \"code_block\", \"todo_li\"],\r\n    defaultType: \"p\",\r\n}\r\n\r\nexport const plugins = [\r\n    ParagraphPlugin(),\r\n    HeadingPlugin({\r\n        h1: {\r\n            hotkey: \"mod+alt+1\",\r\n        },\r\n        h2: {\r\n            hotkey: \"mod+alt+2\",\r\n        },\r\n        h3: {\r\n            hotkey: \"mod+alt+3\",\r\n        },\r\n        h4: {\r\n            hotkey: \"mod+alt+4\",\r\n        },\r\n        h5: {\r\n            hotkey: \"mod+alt+5\",\r\n        },\r\n        h6: {\r\n            hotkey: \"mod+alt+6\",\r\n        },\r\n        levels: 6\r\n    }),\r\n    ListPlugin({\r\n        ul: {\r\n            hotkey: \"mod+.\",\r\n        },\r\n        ol: {\r\n            hotkey: \"mod+/\",\r\n        },\r\n    }),\r\n    BoldPlugin(),\r\n    ItalicPlugin(),\r\n    UnderlinePlugin(),\r\n    SubscriptPlugin({\r\n        subscript: {\r\n            hotkey: \"mod+-\"\r\n        }\r\n    }),\r\n    SuperscriptPlugin({\r\n        superscript: {\r\n            hotkey: \"mod+=\"\r\n        }\r\n    }),\r\n    ResetBlockTypePlugin({\r\n        rules: [\r\n            {\r\n                ...resetBlockTypesCommonRule,\r\n                hotkey: \"enter\",\r\n                predicate: isBlockAboveEmpty,\r\n            },\r\n            {\r\n                ...resetBlockTypesCommonRule,\r\n                hotkey: \"backspace\",\r\n                predicate: isSelectionAtBlockStart,\r\n            },\r\n        ],\r\n    }),\r\n    SoftBreakPlugin({\r\n        rules: [\r\n            {\r\n                hotkey: 'shift+enter',\r\n            },\r\n            {\r\n                hotkey: 'enter',\r\n                query: {\r\n                    allow: [\r\n                        \"code_block\",\r\n                        \"blockquote\",\r\n                    ]\r\n                }\r\n            }\r\n        ],\r\n    }),\r\n    ExitBreakPlugin({\r\n        rules: [\r\n            {\r\n                hotkey: 'mod+enter',\r\n                level: 0,\r\n            },\r\n            {\r\n                hotkey: 'mod+shift+enter',\r\n                before: true,\r\n                level: 0,\r\n            },\r\n            {\r\n                hotkey: 'enter',\r\n                query: {\r\n                    start: true,\r\n                    end: true,\r\n                    allow: HEADING_ELEMENTS,\r\n                },\r\n                level: 0,\r\n            },\r\n        ],\r\n    }),\r\n    TemplateBlocksPlugin(),\r\n]\r\n\r\nexport const withPlugins = [withReact, withHistory, withInlineVoid({ plugins }), withList()] as const;","import { deserializeList, ListPluginOptions, onKeyDownList, renderElementList, SlatePlugin, toggleList } from \"@udecode/slate-plugins\";\r\nimport isHotkey from \"is-hotkey\";\r\nimport { Editor } from \"slate\";\r\n\r\nexport const ListPlugin = (options?: ListPluginOptions): SlatePlugin => ({\r\n    renderElement: renderElementList(options),\r\n    deserialize: deserializeList(options),\r\n    onKeyDown: (e: KeyboardEvent, editor: Editor) => {\r\n        if (options && Object.keys(options).includes(\"ol\")) {\r\n            if (options.ol!.hotkey && isHotkey(options.ol!.hotkey, e)) {\r\n                toggleList(editor, { typeList: \"ol\" })\r\n            }\r\n        }\r\n        if (options && Object.keys(options).includes(\"ul\")) {\r\n            if (options.ul!.hotkey && isHotkey(options.ul!.hotkey!, e)) {\r\n                toggleList(editor, { typeList: \"ul\" })\r\n            }\r\n        }\r\n        \r\n        // trying to rewrite the logic so it will work for multiple list items\r\n        onKeyDownList(options)(e, editor);\r\n    }\r\n})","import { Editor, Point, Range } from \"slate\";\r\n\r\ninterface EditorRangeMatch {\r\n    range: Range | undefined;\r\n    text: string | undefined;\r\n    match: \"\" | RegExpMatchArray | null | undefined;\r\n}\r\n\r\nexport const matchBefore = (editor: Editor, start: Point, match: RegExp, beforeOpts?: any, end?: Point): EditorRangeMatch => {\r\n    const rangeEnd = end || start;\r\n    const before = Editor.before(editor, start, beforeOpts)\r\n    const beforeRange = before && Editor.range(editor, before, rangeEnd);\r\n    const beforeText = beforeRange && Editor.string(editor, beforeRange);\r\n    const beforeMatch = beforeText && beforeText.match(match);\r\n    return {range: beforeRange, text: beforeText, match: beforeMatch};\r\n}\r\n\r\nexport const matchAfter = (editor: Editor, start: Point, match: RegExp, afterOpts?: any): EditorRangeMatch => {\r\n    const after = Editor.after(editor, start, afterOpts);\r\n    const afterRange = Editor.range(editor, start, after);\r\n    const afterText = Editor.string(editor, afterRange);\r\n    const afterMatch = afterText.match(match);\r\n    return {range: afterRange, text: afterText, match: afterMatch};\r\n}","import { Editor, Transforms } from \"slate\";\r\nimport { TemplateBlockProps } from './../interfaces/Templates';\r\n\r\n// insert a new template block and add it to the variable scope\r\nexport const insertTemplateBlock = (editor: Editor, props: TemplateBlockProps) => {\r\n    const templateBlock = { type: \"template-block\", ...props, children: [{text: ''}] }\r\n    Transforms.insertNodes(editor, templateBlock);\r\n    Transforms.move(editor);\r\n}","import React from 'react'\r\nimport ReactDOM from 'react-dom';\r\n\r\nexport const Portal: React.FC = ({ children }) => {\r\n    return ReactDOM.createPortal(children, document.body)\r\n}\r\n","import React, { MouseEventHandler, useEffect, useRef } from 'react'\r\nimport { Range } from 'slate';\r\nimport { ReactEditor, useSlate } from 'slate-react';\r\nimport styled from 'styled-components';\r\nimport { DotAbbreviationRecord, DotAbbreviationValueProps } from '../interfaces/DotAbbrevMeta';\r\n\r\nimport { Portal } from './Portal';\r\n\r\ninterface Props {\r\n    at: Range | null | undefined,\r\n    options: DotAbbreviationRecord,\r\n    pos: number,\r\n    onClickItem?: (editor: ReactEditor, option: [key: string, value: DotAbbreviationValueProps]) => void,\r\n}\r\n\r\ninterface SelectItemProps {\r\n    active: boolean;\r\n    onClick: MouseEventHandler;\r\n}\r\n\r\nexport const FragmentInserterMenu: React.FC<Props> = ({ at, options, pos, onClickItem }) => {\r\n    const ref = useRef<HTMLDivElement | null>(null);\r\n    const editor = useSlate();\r\n\r\n    useEffect(() => {\r\n        if (at && Object.keys(options).length > 0) {\r\n            const el = ref.current;\r\n            const domRange = ReactEditor.toDOMRange(editor, at)\r\n            const rect = domRange.getBoundingClientRect();\r\n\r\n            if (el) {\r\n                el.style.top = `${rect.top + window.pageYOffset + 24}px`\r\n                el.style.left = `${rect.left + window.pageXOffset}px`\r\n            }\r\n        }\r\n    }, [options, editor, at])\r\n    \r\n    if (!at || !Object.keys(options).length)\r\n        return null\r\n\r\n    return (\r\n        <Portal>\r\n            <HangingMenu ref={ref}>\r\n                {Object.entries(options).map(([opt, optVal], i) => (\r\n                    <SelectItem key={opt} active={pos === i} onClick={e => onClickItem && onClickItem(editor, [opt, optVal])}>\r\n                        <div className=\"name\">\r\n                            {opt}\r\n                        </div>\r\n                        <div className=\"description\">\r\n                            {optVal.description}\r\n                        </div>\r\n                    </SelectItem>\r\n                ))\r\n                }\r\n            </HangingMenu>\r\n        </Portal>\r\n    )\r\n}\r\n\r\nconst SelectItem: React.FC<SelectItemProps> = ({ active, children, onClick }) => {\r\n    return (\r\n        <div className={`selector-item ${active ? \"active-item\" : \"\"}`} onMouseDown={onClick}>\r\n            {children}\r\n        </div>\r\n    )\r\n}\r\n\r\nconst HangingMenu = styled.div`\r\n    top: -9999px;\r\n    left: -9999px;\r\n    position: absolute;\r\n    z-index: 1;\r\n    padding: 3px;\r\n    background: #eee;\r\n    border-radius: 4px;\r\n    box-shadow: 0 1px 5px rgba(0,0,0,0.2);\r\n    overflow-y: scroll;\r\n    max-width: 40vw;\r\n    max-height: 10rem;\r\n    \r\n    .selector-item {\r\n        padding: 1px 3px;\r\n        border-radius: 3px;\r\n        background-color: transparent;\r\n        cursor: pointer;\r\n        transition: 0.3s ease all;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        \r\n        .name {\r\n            font-weight: bold;\r\n            margin-right: 10px;\r\n            text-align: left;\r\n        }\r\n\r\n        .description {\r\n            display: flex;\r\n            flex-grow: 1;\r\n            color: #444;\r\n            font-size: 0.8rem;\r\n            justify-content: right;\r\n        }\r\n\r\n        &:hover {\r\n            background-color: #d2e6ff;\r\n        }\r\n        \r\n        &:active {\r\n            background-color: #a2c036;\r\n        }\r\n    }\r\n\r\n    .active-item {\r\n        background-color: #b4d5ff;\r\n    }\r\n\r\n`","import { useCallback, useState } from \"react\";\r\nimport { Editor, Location, Range, Transforms } from \"slate\";\r\nimport { matchBefore, matchAfter } from \"../../utils/matches\";\r\nimport { DotAbbreviationRecord, DotAbbreviationValueProps } from \"./interfaces/DotAbbrevMeta\";\r\n\r\nexport const useFragmentInserter = (abbrevs: DotAbbreviationRecord) => {\r\n    const [target, setTarget] = useState<Range | null>();\r\n    const [index, setIndex] = useState(0);\r\n    const [search, setSearch] = useState(\"\");\r\n\r\n    const searchedAbbrevs = Object.fromEntries(Object.entries(abbrevs).filter(([key]) => \r\n        (search !== \"$\") ? key.toLowerCase().startsWith(search.toLowerCase()) : !!key\r\n    ));\r\n    \r\n    const onInsertFragment = useCallback((editor: Editor, data: [key: string, value: DotAbbreviationValueProps]) => {\r\n        if (!!target) {\r\n            let [, value] = data;\r\n            Transforms.select(editor, target);\r\n            Editor.insertFragment(editor, value.value)\r\n            setTarget(null)\r\n        }\r\n    }, [target])\r\n    \r\n    \r\n    const onKeyDownFragmentInserter = useCallback((event: React.KeyboardEvent, editor: Editor) => {\r\n        if (target) {\r\n            switch (event.key) {\r\n                case \"ArrowDown\":\r\n                    event.preventDefault();\r\n                    const prevIndex = index >= Object.keys(searchedAbbrevs).length - 1 ? 0 : index + 1\r\n                    setIndex(prevIndex);\r\n                    break;\r\n                case \"ArrowUp\":\r\n                    event.preventDefault();\r\n                    const nextIndex = index <= 0 ? Object.keys(searchedAbbrevs).length - 1 : index - 1\r\n                    setIndex(nextIndex);\r\n                    break;\r\n                case \"Tab\":\r\n                case \"Enter\":\r\n                    event.preventDefault();\r\n                    Transforms.select(editor, (target as Location));\r\n                    let keyToGet = Object.keys(searchedAbbrevs)[index]\r\n                    let {value: fragmentToInsert} = abbrevs[keyToGet]\r\n                    Editor.insertFragment(editor, fragmentToInsert);\r\n                    setTarget(null);\r\n                    break;\r\n                case \"Escape\":\r\n                    event.preventDefault();\r\n                    setTarget(null);\r\n                    break;\r\n            }\r\n        }\r\n    }, [index, search, target])\r\n    \r\n    const onChangeFragmentInserter = useCallback((editor: Editor) => {\r\n        const { selection } = editor;\r\n        // if nothing is currently selected under the cursor\r\n        if (selection && Range.isCollapsed(selection)) {\r\n            const [start] = Range.edges(selection);\r\n            // if the two characters beforce the cursor are {{, select them and replace with a template block\r\n            const wordBefore = Editor.before(editor, start, {unit: \"word\"})\r\n            const wordBeforeMatch = wordBefore && matchBefore(editor, wordBefore, /^\\.(\\w+|\\$)$/, {}, start)\r\n            let beforeWordRange, beforeWordText, beforeWordMatch;\r\n            if (wordBeforeMatch) {\r\n                beforeWordRange = wordBeforeMatch.range;\r\n                beforeWordText = wordBeforeMatch.text;\r\n                beforeWordMatch = wordBeforeMatch.match;\r\n            }\r\n            // let {range: beforeWordRange, text: beforeWordText, match: beforeWordMatch} = wordBeforeMatch;\r\n            const {match: afterMatch} = matchAfter(editor, start, /^(\\s|$)/)\r\n            if (beforeWordMatch && afterMatch) {\r\n                setTarget(beforeWordRange)\r\n                setSearch(beforeWordMatch[1]);\r\n                setIndex(0);\r\n                return;\r\n            }\r\n        }\r\n\r\n        setTarget(null);\r\n    }, [])\r\n    \r\n    return {\r\n        target,\r\n        search,\r\n        index,\r\n        searchedAbbrevs,\r\n\r\n        onInsertFragment,\r\n        onKeyDownFragmentInserter,\r\n        onChangeFragmentInserter,\r\n    }\r\n}","import { atom } from \"recoil\";\r\nimport { DotAbbreviationRecord } from \"../editor/newPlugins/FragmentInserter/interfaces/DotAbbrevMeta\";\r\n\r\nconst existingAbbrevs = localStorage.getItem(\"dotAbbrevs\")\r\n\r\nexport const DotAbbrevsState = atom<DotAbbreviationRecord>({\r\n    key: \"DotAbbreviations\",\r\n    default: existingAbbrevs ? JSON.parse(existingAbbrevs) : {}\r\n})","import { Editor, Node, Text } from 'slate';\r\nimport unified from 'unified';\r\nimport { slateToRemark } from 'remark-slate-transformer';\r\nimport stringify from 'remark-stringify';\r\nimport * as clipboard from \"clipboard-polyfill\";\r\nimport { serializeHTMLFromNodes, SlatePlugin } from '@udecode/slate-plugins';\r\n\r\n// two packages seem to work to this end:\r\n// https://github.com/accordproject/markdown-transform/tree/master/packages/markdown-slate/\r\n// https://github.com/inokawa/remark-slate-transformer\r\n\r\ntype OptionType = {\r\n    label: string,\r\n    value: string\r\n}\r\n\r\nexport const toMarkdown = (editor: Editor): string => {\r\n    const preprocessed = editor.children.map(preprocessMDNode)\r\n    const processor = unified().use(slateToRemark).use(stringify, {bullet: \"-\"})\r\n    const ast = processor.runSync({\r\n        type: \"root\",\r\n        children: preprocessed,\r\n    });\r\n    const text = processor.stringify(ast);\r\n    // i can't figure out how to remove the unnecessary line breaks in the lists using remark's serialiser\r\n    // so i'm going to do it the stupid way using regex\r\n    let textLines = text.split(\"\\n\")\r\n    // convert to a boolean index of where there are list items or not\r\n    // this will miss empty list items - the serialiser only introduces the spaces after the bullet point when there is content in the item\r\n    let matches = textLines.map(s => !!s.match(/^\\s*(-|\\d+\\.)\\s+/g))\r\n    // look for a true/false/true block\r\n    // it's easier if you just convert it to a string and use regex but again this feels very dumb to me for some reason\r\n    let matchString = matches.map(s => s ? 't' : 'f').join('')\r\n    let tftBlocks = matchString.matchAll(/t(ft)+/g)\r\n    let toRemove: number[] = []\r\n    for (let tft of tftBlocks) {\r\n        let [matched] = tft;\r\n        let { index } = tft;\r\n        // i wish there was a way to do this without the filter or the spread operator but js is dumb\r\n        let fPos = [...matched].map((val, idx) => (val === 'f') ? (index!+idx) : -1).filter(val => (val >= 0))\r\n        toRemove = toRemove.concat(fPos)\r\n    }\r\n    let finalLines = textLines.map((val, idx) => (!toRemove.includes(idx)) ? val : null).filter(val => val !== null)\r\n    let fixedText = finalLines.join('\\n')\r\n\r\n    return fixedText;\r\n}\r\n\r\nexport const toClipboardMD = (editor: Editor): void => {\r\n    navigator.clipboard.writeText(toMarkdown(editor)).then(() => {\r\n        window.alert(\"Copied successfully!\")\r\n    }, () => {\r\n        window.alert(\"Copying failed!\")\r\n    })\r\n}\r\n\r\nconst templatesToText = (node: Node): Node => {\r\n    // console.log(node)\r\n    let newNode = {...node};\r\n\r\n    if (newNode.children)\r\n        newNode.children = (newNode.children as Node[]).map(templatesToText)\r\n\r\n    switch (newNode.type) {\r\n        case \"template-block\":\r\n            switch (newNode.templateType) {\r\n                case \"select\":\r\n                    return {text: (newNode.defaultValue ? (newNode.defaultValue as OptionType).value : \"\")}\r\n                case \"multiselect\":\r\n                    // console.table(newNode.defaultValue)\r\n                    return {text: (newNode.defaultValue ? (newNode.defaultValue as OptionType[]).map(opt => opt.value).join(\", \") : \"\")}\r\n                case \"date\":\r\n                    let dateAsString, nodeDate;\r\n                    if (newNode.defaultValue) {\r\n                        nodeDate = (typeof newNode.defaultValue === \"string\") ? new Date(newNode.defaultValue) : newNode.defaultValue as Date;\r\n                    } else {\r\n                        nodeDate = new Date();\r\n                    }\r\n                    dateAsString = `${nodeDate.getDate()}/${nodeDate.getMonth() + 1}/${nodeDate.getFullYear()}`\r\n                    // console.log(dateAsString)\r\n                    return {text: dateAsString ? dateAsString : \"\"}\r\n                default:\r\n                    return {text: \"\"}\r\n            }\r\n        default:\r\n            return newNode\r\n    }\r\n}\r\n\r\nconst preprocessMDNode = (node: Node): Node => {\r\n    let newNode = {...node};\r\n    // preprocess text nodes so that they return the right formatting\r\n    if (Text.isText(newNode)) {\r\n        newNode.strong = newNode.bold\r\n        newNode.emphasis = newNode.italic\r\n    }\r\n\r\n    if (newNode.children)\r\n        newNode.children = (newNode.children as Node[]).map(preprocessMDNode)\r\n\r\n    switch (newNode.type) {\r\n        case \"template-block\":\r\n            return templatesToText(node)\r\n        case \"p\":\r\n            return {...newNode, type: \"paragraph\"}\r\n        case \"h1\":\r\n            return {...newNode, type: \"heading\", depth: 1}\r\n        case \"h2\":\r\n            return {...newNode, type: \"heading\", depth: 2}\r\n        case \"h3\":\r\n            return {...newNode, type: \"heading\", depth: 3}\r\n        case \"h4\":\r\n            return {...newNode, type: \"heading\", depth: 4}\r\n        case \"h5\":\r\n            return {...newNode, type: \"heading\", depth: 5}\r\n        case \"h6\":\r\n            return {...newNode, type: \"heading\", depth: 6}\r\n        case \"ul\":\r\n            return {...newNode, type: \"list\", ordered: false}\r\n        case \"ol\":\r\n            return {...newNode, type: \"list\", ordered: true}\r\n        case \"li\":\r\n            return {...newNode, type: \"listItem\"}\r\n        default:\r\n            return newNode\r\n    }\r\n}\r\n\r\nexport const toClipboardHTML = (editor: Editor, plugins: SlatePlugin[]): void => {\r\n    // can't use the new async clipboard API because it doesn't support rich text\r\n    // i normally try to avoid installing packages if i can help it but anyway, here we are\r\n    const item = new clipboard.ClipboardItem({\r\n        \"text/html\": new Blob([serializeHTMLFromNodes({ plugins, nodes: editor.children })], {type: \"text/html\"}),\r\n    })\r\n    try {\r\n        clipboard.write([item]);\r\n        window.alert(\"Copied successfully!\")\r\n    } catch (error) {\r\n        window.alert(\"Copying failed!\")\r\n    }\r\n}","import React from 'react'\r\nimport styled from 'styled-components';\r\n\r\nexport const FunctionButtonsContainer: React.FC = ({ children }) => {\r\n    return (\r\n        <HorizontalScroller>\r\n            {children}\r\n        </HorizontalScroller>\r\n    )\r\n}\r\n\r\nconst HorizontalScroller = styled.div`\r\n    display: flex;\r\n    flex-grow: 1;\r\n    overflow-x: scroll;\r\n    scrollbar-width: none;\r\n    \r\n    > .slate-ToolbarButton {\r\n        min-width: 25px;\r\n    }\r\n    \r\n    &::-webkit-scrollbar {\r\n        height: 0;\r\n    }\r\n`","export function downloadFile(fileCreator: Blob | (() => Blob), fileName: string): void {\r\n    const blob = (typeof fileCreator === \"function\") ? fileCreator() : fileCreator;\r\n    const fileDownloadURL = URL.createObjectURL(blob);\r\n    let tempLink = document.createElement(\"a\")\r\n    tempLink.href = fileDownloadURL;\r\n    tempLink.setAttribute(\"download\", fileName)\r\n    tempLink.setAttribute(\"target\", \"_blank\")\r\n    tempLink.click()\r\n    tempLink.remove()\r\n}\r\n\r\nexport function uploadSingleFile(uploadHandler: (file: File, fr: FileReader) => void, acceptExts?: string[]): void {\r\n    const fileSelector = document.createElement(\"input\");\r\n    fileSelector.setAttribute(\"type\", \"file\")\r\n    fileSelector.setAttribute(\"accept\", acceptExts ? acceptExts.map(v => `.${v}`).join(\",\") : \"\")\r\n    fileSelector.click()\r\n    fileSelector.addEventListener(\"change\", event => {\r\n        if (fileSelector.files && fileSelector.files.length >= 1) {\r\n            let file = fileSelector.files![0], fr = new FileReader();\r\n            let fileExt = file.name.match(/\\.([^.]+)$/)![1];\r\n            let acceptFile = acceptExts ? acceptExts.includes(fileExt) : true;\r\n            if (acceptFile)\r\n                uploadHandler(file, fr)\r\n        }\r\n    })\r\n}","\r\nexport const InitialState = JSON.parse(`\r\n[\r\n    {\r\n        \"type\": \"h1\",\r\n        \"children\": [\r\n            {\r\n                \"text\": \"Welcome to FastDischarge!\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"p\",\r\n        \"children\": [\r\n            {\r\n                \"text\": \"FastDischarge has lots of features that will help you to document faster:\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"ul\",\r\n        \"children\": [\r\n            {\r\n                \"type\": \"li\",\r\n                \"children\": [\r\n                    {\r\n                        \"type\": \"p\",\r\n                        \"children\": [\r\n                            {\r\n                                \"text\": \"Template blocks\"\r\n                            }\r\n                        ]\r\n                    },\r\n                    {\r\n                        \"type\": \"ul\",\r\n                        \"children\": [\r\n                            {\r\n                                \"type\": \"li\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"type\": \"p\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"text\": \"If you frequently choose out of a set list of options, make a \"\r\n                                            },\r\n                                            {\r\n                                                \"text\": \"selection\",\r\n                                                \"italic\": true\r\n                                            },\r\n                                            {\r\n                                                \"text\": \" template by typing in 2 {'s: \"\r\n                                            },\r\n                                            {\r\n                                                \"type\": \"template-block\",\r\n                                                \"templateType\": \"select\",\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"text\": \"\"\r\n                                                    }\r\n                                                ],\r\n                                                \"name\": \"fruits\",\r\n                                                \"opts\": [\r\n                                                    {\r\n                                                        \"label\": \"orange\",\r\n                                                        \"value\": \"orange\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"apple\",\r\n                                                        \"value\": \"apple\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"pear\",\r\n                                                        \"value\": \"pear\"\r\n                                                    }\r\n                                                ],\r\n                                                \"defaultValue\": {\r\n                                                    \"label\": \"pear\",\r\n                                                    \"value\": \"pear\"\r\n                                                }\r\n                                            },\r\n                                            {\r\n                                                \"text\": \"\"\r\n                                            }\r\n                                        ]\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"type\": \"li\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"type\": \"p\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"text\": \"Or if you need to choose multiple options at once, use a multiple selection template by typing in 2 ['s: \"\r\n                                            },\r\n                                            {\r\n                                                \"type\": \"template-block\",\r\n                                                \"templateType\": \"multiselect\",\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"text\": \"\"\r\n                                                    }\r\n                                                ],\r\n                                                \"name\": \"berries\",\r\n                                                \"opts\": [\r\n                                                    {\r\n                                                        \"label\": \"blueberry\",\r\n                                                        \"value\": \"blueberry\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"raspberry\",\r\n                                                        \"value\": \"raspberry\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"strawberry\",\r\n                                                        \"value\": \"strawberry\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"watermelon\",\r\n                                                        \"value\": \"watermelon\"\r\n                                                    }\r\n                                                ],\r\n                                                \"defaultValue\": [\r\n                                                    {\r\n                                                        \"label\": \"blueberry\",\r\n                                                        \"value\": \"blueberry\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"raspberry\",\r\n                                                        \"value\": \"raspberry\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"strawberry\",\r\n                                                        \"value\": \"strawberry\"\r\n                                                    },\r\n                                                    {\r\n                                                        \"label\": \"watermelon\",\r\n                                                        \"value\": \"watermelon\"\r\n                                                    }\r\n                                                ]\r\n                                            },\r\n                                            {\r\n                                                \"text\": \"\"\r\n                                            }\r\n                                        ]\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"type\": \"li\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"type\": \"p\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"text\": \"To pick a date type in 2 @'s: \"\r\n                                            },\r\n                                            {\r\n                                                \"type\": \"template-block\",\r\n                                                \"templateType\": \"date\",\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"text\": \"\"\r\n                                                    }\r\n                                                ],\r\n                                                \"name\": \"date\"\r\n                                            },\r\n                                            {\r\n                                                \"text\": \"\"\r\n                                            }\r\n                                        ]\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"type\": \"li\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"type\": \"p\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"text\": \"To template a numeric field e.g. age, type in 2 #'s: \"\r\n                                            },\r\n                                            {\r\n                                                \"type\": \"template-block\",\r\n                                                \"templateType\": \"number\",\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"text\": \"\"\r\n                                                    }\r\n                                                ],\r\n                                                \"name\": \"number\",\r\n                                                \"defaultValue\": 120\r\n                                            },\r\n                                            {\r\n                                                \"text\": \"\"\r\n                                            }\r\n                                        ]\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"type\": \"li\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"type\": \"p\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"text\": \"To create a void template (whose only purpose is to be typed over), type in 2 *'s: \"\r\n                                            },\r\n                                            {\r\n                                                \"type\": \"template-block\",\r\n                                                \"templateType\": \"void\",\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"text\": \"\"\r\n                                                    }\r\n                                                ],\r\n                                                \"name\": \"myvoid\"\r\n                                            },\r\n                                            {\r\n                                                \"text\": \"\"\r\n                                            }\r\n                                        ]\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                \"type\": \"li\",\r\n                \"children\": [\r\n                    {\r\n                        \"type\": \"p\",\r\n                        \"children\": [\r\n                            {\r\n                                \"text\": \"Snippets\"\r\n                            }\r\n                        ]\r\n                    },\r\n                    {\r\n                        \"type\": \"ul\",\r\n                        \"children\": [\r\n                            {\r\n                                \"type\": \"li\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"type\": \"p\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"text\": \"Similar to PowerChart or EPIC, you can also select arbitrary parts of the document and save them as named snippets to be recalled later. Try highlighting this sentence and clicking the dot icon in the tooltip!\"\r\n                                            }\r\n                                        ]\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"p\",\r\n        \"children\": [\r\n            {\r\n                \"text\": \"FastDischarge also comes with all the rich text editing features you know and love! For more information, click the help button on the bottom right (?).\"\r\n            }\r\n        ]\r\n    }\r\n]\r\n`);","import React from 'react'\r\nimport { useForm } from \"react-hook-form\";\r\nimport { DotAbbreviationMetaProps, DotAbbreviationRecord, DotAbbreviationValueProps } from './../interfaces/DotAbbrevMeta';\r\nimport { Editor } from 'slate';\r\nimport { useEditor } from 'slate-react';\r\nimport styled from 'styled-components';\r\nimport { Portal } from 'react-portal';\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\nimport { FancyButton } from '../../../../components/FancyButton';\r\nimport { OneLine } from './../../../../components/OneLine';\r\n\r\ninterface Props {\r\n    setComplete: (value: boolean) => void;\r\n    setFragments: (value: any) => void;\r\n    lastSelection: any;\r\n}\r\n\r\n// popup with a form to create a new snippet\r\nexport const FragmentInserterPopup: React.FC<Props> = ({ setComplete, setFragments, lastSelection }) => {\r\n    const editor = useEditor();\r\n    \r\n    const { register, handleSubmit, errors } = useForm()\r\n    const onSubmit = (data: DotAbbreviationMetaProps) => {\r\n        const { name, description } = data;\r\n        const existingAbbrevs = localStorage.getItem(\"dotAbbrevs\") && JSON.parse(localStorage.getItem(\"dotAbbrevs\")!)\r\n        // get the fragment\r\n        let fragment = Editor.fragment(editor, lastSelection)\r\n        // first a dialogue should pop up asking the user to name the fragment\r\n        let fragmentObject: DotAbbreviationRecord = {}\r\n        fragmentObject[name] = {description, value: fragment} as DotAbbreviationValueProps;\r\n        let newAbbrevs;\r\n        if (existingAbbrevs) {\r\n            newAbbrevs = {...existingAbbrevs, ...fragmentObject}\r\n        } else {\r\n            newAbbrevs = {...fragmentObject}\r\n        }\r\n        setFragments(newAbbrevs);\r\n        localStorage.setItem(\"dotAbbrevs\", JSON.stringify(newAbbrevs))\r\n        setComplete(true);\r\n    }\r\n\r\n    return (\r\n        <Portal>\r\n            <DarkWrapper>\r\n                <PopupMenu>\r\n                    <OneLine style={{marginBottom: \"10px\"}}>\r\n                        <h2 style={{margin: 0}}>\r\n                            Save new snippet\r\n                        </h2>\r\n                        <FancyButton onClick={() => {\r\n                            setComplete(true);\r\n                        }}><InlineIcon icon=\"eva:close-fill\" /></FancyButton>\r\n                    </OneLine>\r\n                    <form onSubmit={handleSubmit(onSubmit)}>\r\n                        <FormRow>\r\n                            {errors.name && <ErrorSpan>Invalid name!</ErrorSpan>}\r\n                        </FormRow>\r\n                        <FormRow>\r\n                            <label htmlFor=\"name\">Name*: </label>\r\n                            <PrettyTextInput type=\"text\" name=\"name\" ref={register({required: true, pattern: /^\\w+/i})} />\r\n                        </FormRow>\r\n                        <FormRow>\r\n                            <label htmlFor=\"description\">Description: </label>\r\n                            <PrettyTextArea name=\"description\" ref={register}></PrettyTextArea>\r\n                        </FormRow>\r\n                        <FancyButton type=\"submit\" theme={{main: {border: \"1px solid lightgrey\", backgroundColor: \"#eee\", padding: \"5px\"}}}>Submit</FancyButton>\r\n                    </form>\r\n                </PopupMenu>\r\n            </DarkWrapper>\r\n        </Portal>\r\n    )\r\n}\r\n\r\nconst PopupMenu = styled.div`\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    background-color: white;\r\n    padding: 10px;\r\n    border: 1px solid lightgrey;\r\n    border-radius: 5px;\r\n`\r\n\r\nconst DarkWrapper = styled.div`\r\n    background-color: rgba(0,0,0,0.5);\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n`\r\n\r\nconst FormRow = styled.div`\r\n    display: flex;\r\n    margin-bottom: 5px;\r\n\r\n    > *:nth-child(2) {\r\n        flex-grow: 1;\r\n    }\r\n`\r\n\r\nconst PrettyTextInput = styled.input`\r\n    border-radius: 5px;\r\n    padding: 5px;\r\n    outline: none;\r\n    border: 1px solid lightgrey;\r\n    margin-left: 5px;\r\n    transition: 0.3s ease all;\r\n\r\n    &:focus {\r\n        box-shadow: 0 0 0 2px #b4d5ff;\r\n    }\r\n`\r\n\r\nconst PrettyTextArea = styled.textarea`\r\n    border-radius: 5px;\r\n    padding: 5px;\r\n    outline: none;\r\n    border: 1px solid lightgrey;\r\n    margin-left: 5px;\r\n    transition: 0.3s ease all;\r\n\r\n    &:focus {\r\n        box-shadow: 0 0 0 2px #b4d5ff;\r\n    }\r\n`\r\n\r\nconst ErrorSpan = styled.span`\r\n    background-color: #f56991;\r\n    color: white;\r\n    padding: 5px;\r\n    border-radius: 5px;\r\n    font-size: small;\r\n`","import { BalloonToolbar, EditablePlugins, HeadingToolbar, pipe, SlateDocument, ToolbarButton, ToolbarElement, ToolbarList, ToolbarMark } from '@udecode/slate-plugins';\r\nimport React, { useMemo, useState } from 'react'\r\nimport { useRecoilState, useSetRecoilState } from 'recoil';\r\nimport { createEditor, Node, Transforms } from 'slate';\r\nimport { Slate } from 'slate-react';\r\nimport { InlineIcon } from \"@iconify/react-with-api\";\r\nimport SimpleBar from 'simplebar-react';\r\nimport Modal from \"react-modal\";\r\nimport \"simplebar/dist/simplebar.min.css\"\r\nimport \"tippy.js/themes/light-border.css\"\r\n\r\nimport { plugins, withPlugins } from '../editor/config';\r\nimport { useTemplates } from './../editor/newPlugins/TemplateBlocks/useTemplates';\r\nimport { FragmentInserterMenu } from '../editor/newPlugins/FragmentInserter/components/FragmentInserterMenu';\r\nimport { useFragmentInserter } from '../editor/newPlugins/FragmentInserter/useFragmentInserter';\r\nimport { DotAbbrevsState } from './../context/DotAbbrevs';\r\nimport { saveDotAbbrev } from './../editor/newPlugins/FragmentInserter/transforms/DotAbbreviations';\r\nimport { toClipboardHTML, toClipboardMD } from '../editor/utils/serialise';\r\nimport { FunctionButtonsContainer } from './FunctionButtonsContainer';\r\nimport { OneLine } from './OneLine';\r\nimport { FancyButton } from './FancyButton';\r\nimport { downloadFile, uploadSingleFile } from './../utils/fileHandling';\r\nimport { EditorVariablesState, findTemplateVariables } from './../context/EditorContent';\r\nimport { InitialState as initialValue } from '../context/InitialState';\r\nimport { FragmentInserterPopup } from './../editor/newPlugins/FragmentInserter/components/FragmentInserterPopup';\r\nimport { DotAbbreviationMetaProps } from './../editor/newPlugins/FragmentInserter/interfaces/DotAbbrevMeta';\r\n\r\nModal.setAppElement(\"#root\");\r\n\r\nexport const TextEditor: React.FC = () => {\r\n    const startingState = JSON.parse(localStorage.getItem(\"content\") as string) || initialValue;\r\n    const [value, setValue] = useState<Node[]>(startingState);\r\n    const [dotAbbrevs, setDotAbbrevs] = useRecoilState(DotAbbrevsState);\r\n    const setTemplateVars = useSetRecoilState(EditorVariablesState);\r\n    const [settingsOpen, setSettingsOpen] = useState(false);\r\n    const [createSnippet, setCreateSnippet] = useState(false);\r\n    const [lastSelection, setLastSelection] = useState<any>();\r\n\r\n    const editor = useMemo(() => pipe(createEditor(), ...withPlugins), []);\r\n    \r\n    const { onChangeTemplates } = useTemplates(editor);\r\n    const { target, index, search, searchedAbbrevs, onInsertFragment, onChangeFragmentInserter, onKeyDownFragmentInserter } = useFragmentInserter(dotAbbrevs);\r\n\r\n    const exportTemplateAsFile = () => downloadFile(new Blob([JSON.stringify(editor.children)], {type: \"application/json\"}), \"template.fdt\")\r\n    \r\n    const exportAbbrevsAsFile = () => downloadFile(new Blob([JSON.stringify(dotAbbrevs)], {type: \"application/json\"}), \"abbreviations.fda\")\r\n\r\n    const loadTemplateFromFile = () => uploadSingleFile((file, fr) => {\r\n        fr.readAsText(file);\r\n        fr.onload = event => {\r\n            let loaded = JSON.parse((event.target!.result as string));\r\n            setValue(loaded);\r\n        }\r\n    }, [\"fdt\"])\r\n    \r\n    const loadAbbrevsFromFile = () => uploadSingleFile((file, fr) => {\r\n        fr.readAsText(file);\r\n        fr.onload = event => {\r\n            let loaded = JSON.parse((event.target!.result as string));\r\n            setDotAbbrevs(loaded);\r\n        }\r\n    }, [\"fda\"])\r\n\r\n    return (\r\n        <>\r\n            <Slate editor={editor} value={value} onChange={newValue => {\r\n                setValue(newValue as SlateDocument);\r\n                const content = JSON.stringify(value);\r\n                localStorage.setItem(\"content\", content)\r\n                let vars = findTemplateVariables(editor);\r\n                setTemplateVars(vars);\r\n\r\n                onChangeFragmentInserter(editor);\r\n                onChangeTemplates(editor);\r\n            }}>\r\n                <HeadingToolbar styles={{\r\n                    root: {\r\n                        padding: '1px 3px',\r\n                        margin: 0,\r\n                        display: \"flex\",\r\n                        justifyContent: \"space-between\",\r\n                    }\r\n                }}>\r\n                    <FunctionButtonsContainer>\r\n                        <ToolbarMark type=\"bold\" icon={<InlineIcon icon=\"mdi:format-bold\" />} tooltip={{content: \"Bold text (Ctrl+B)\", theme: \"light-border\"}} />\r\n                        <ToolbarMark type=\"italic\" icon={<InlineIcon icon=\"mdi:format-italic\" />} tooltip={{content: \"Italicise text (Ctrl+I)\", theme: \"light-border\"}} />\r\n                        <ToolbarMark type=\"underline\" icon={<InlineIcon icon=\"mdi:format-underline\" />} tooltip={{content: \"Underline text (Ctrl+U)\", theme: \"light-border\"}}/>\r\n                        <ToolbarMark type=\"subscript\" clear=\"superscript\" icon={<InlineIcon icon=\"mdi:format-subscript\" />} tooltip={{content: \"Subscript text (Ctrl+-)\", theme: \"light-border\"}}/>\r\n                        <ToolbarMark type=\"superscript\" clear=\"subscript\" icon={<InlineIcon icon=\"mdi:format-superscript\" />} tooltip={{content: \"Superscript text (Ctrl+=)\", theme: \"light-border\"}}/>\r\n                        <ToolbarElement type=\"h1\" icon={<InlineIcon icon=\"mdi:numeric-1-box\" />} tooltip={{content: \"Set heading 1 (Ctrl+Alt+1)\", theme: 'light-border'}}/>\r\n                        <ToolbarElement type=\"h2\" icon={<InlineIcon icon=\"mdi:numeric-2-box\" />} tooltip={{content: \"Set heading 2 (Ctrl+Alt+2)\", theme: 'light-border'}}/>\r\n                        <ToolbarElement type=\"h3\" icon={<InlineIcon icon=\"mdi:numeric-3-box\" />} tooltip={{content: \"Set heading 3 (Ctrl+Alt+3)\", theme: 'light-border'}}/>\r\n                        <ToolbarElement type=\"h4\" icon={<InlineIcon icon=\"mdi:numeric-4-box\" />} tooltip={{content: \"Set heading 4 (Ctrl+Alt+4)\", theme: 'light-border'}}/>\r\n                        <ToolbarElement type=\"h5\" icon={<InlineIcon icon=\"mdi:numeric-5-box\" />} tooltip={{content: \"Set heading 5 (Ctrl+Alt+5)\", theme: 'light-border'}}/>\r\n                        <ToolbarElement type=\"h6\" icon={<InlineIcon icon=\"mdi:numeric-6-box\" />} tooltip={{content: \"Set heading 6 (Ctrl+Alt+6)\", theme: 'light-border'}}/>\r\n                        <ToolbarList typeList=\"ul\" icon={<InlineIcon icon=\"mdi:format-list-bulleted\" />} tooltip={{content: \"Set bulleted list (Ctrl+.)\", theme: 'light-border'}} />\r\n                        <ToolbarList typeList=\"ol\" icon={<InlineIcon icon=\"mdi:format-list-numbered\" />} tooltip={{content: \"Set numbered list (Ctrl+/)\", theme: 'light-border'}} />\r\n                        <ToolbarButton onMouseDown={e => toClipboardMD(editor)} icon={<InlineIcon icon=\"ion:copy-outline\" />} tooltip={{content: \"Copy to clipboard as plain text/Markdown\", theme: 'light-border'}} />\r\n                        <ToolbarButton onMouseDown={e => toClipboardHTML(editor, plugins)} icon={<InlineIcon icon=\"ion:copy\" />} tooltip={{content: \"Copy to clipboard\", theme: 'light-border'}} />\r\n                        <ToolbarButton onMouseDown={e => {e.preventDefault(); Transforms.insertText(editor, \".$\")}} icon={<InlineIcon icon=\"uil:brackets-curly\" />} tooltip={{content: \"Insert a snippet\", theme: 'light-border'}} />\r\n                        <ToolbarButton onMouseDown={e => exportTemplateAsFile()} icon={<InlineIcon icon=\"bx:bxs-download\" />} tooltip={{content: \"Save contents of editor to a file\", theme: \"light-border\"}} />\r\n                        <ToolbarButton onMouseDown={e => loadTemplateFromFile()} icon={<InlineIcon icon=\"ic:baseline-file-upload\" />} tooltip={{content: \"Load fdt file into editor\", theme: \"light-border\"}} />\r\n                    </FunctionButtonsContainer>\r\n                    <div className=\"settings-buttons\">\r\n                        <ToolbarButton onMouseDown={e => setSettingsOpen(true)} icon={<InlineIcon icon=\"carbon:settings-adjust\" />} tooltip={{content: \"Settings\", theme: \"light-border\"}} />\r\n                    </div>\r\n                </HeadingToolbar>\r\n                <SimpleBar className=\"editor\">\r\n                    <EditablePlugins plugins={plugins} placeholder=\"Enter some text...\"\r\n                        onKeyDown={[onKeyDownFragmentInserter]} onKeyDownDeps={[index, target, search]}\r\n                        spellCheck autoFocus />\r\n                    <BalloonToolbar theme=\"dark\" arrow={true}>\r\n                        <ToolbarButton onMouseDown={e => {\r\n                            setCreateSnippet(true);\r\n                            setLastSelection(editor.selection);\r\n                        }} icon={<InlineIcon icon=\"bi:dot\" />} tooltip={{content: \"Store selection as a snippet\", theme: \"light-border\"}} />\r\n                    </BalloonToolbar>\r\n                    <FragmentInserterMenu at={target} pos={index} options={searchedAbbrevs} onClickItem={onInsertFragment} />\r\n                    {createSnippet && <FragmentInserterPopup setComplete={v => setCreateSnippet(!v)} setFragments={setDotAbbrevs} lastSelection={lastSelection} />}\r\n                </SimpleBar>\r\n            </Slate>\r\n            <Modal isOpen={settingsOpen} onRequestClose={() => setSettingsOpen(false)}>\r\n                <OneLine>\r\n                    <h1 style={{display: \"inline-block\", margin: 0}}>Settings</h1>\r\n                    <FancyButton onClick={() => setSettingsOpen(false)}><InlineIcon icon=\"eva:close-fill\" /></FancyButton>\r\n                </OneLine>\r\n                <h2>Abbreviations</h2>\r\n                <p>Load my abbreviations: <FancyButton onClick={e => loadAbbrevsFromFile()}><InlineIcon icon=\"ic:baseline-file-upload\" /></FancyButton></p>\r\n                <p>Save my abbreviations: <FancyButton onClick={e => exportAbbrevsAsFile()}><InlineIcon icon=\"bx:bxs-download\" /></FancyButton></p>\r\n                <p>[this section under construction!]</p>\r\n            </Modal>\r\n        </>\r\n    )\r\n}\r\n","import { useCallback, useEffect, useState } from \"react\";\r\nimport { Editor, Path, Range, Transforms } from 'slate';\r\n\r\nimport { matchBefore } from './../../utils/matches';\r\nimport { insertTemplateBlock } from './transforms/InsertTemplateBlock';\r\nimport { isTemplateBlock } from './transforms/NavigateTemplates';\r\n\r\nexport const useTemplates = (editor: Editor) => {\r\n    const [target, setTarget] = useState<Range | null>();\r\n    const [insertTemplate, setInsertTemplate] = useState(false);\r\n    const [replaceText, setReplaceText] = useState(\"\");\r\n\r\n    // useEffect hook for inserting template tags\r\n    useEffect(() => {\r\n        if (!!target && insertTemplate) {\r\n            Transforms.select(editor, target!);\r\n            switch (replaceText) {\r\n                case \"{{\":\r\n                    insertTemplateBlock(editor, {templateType: \"select\"})\r\n                    break;\r\n                case \"[[\":\r\n                    insertTemplateBlock(editor, {templateType: \"multiselect\"})\r\n                    break;\r\n                case \"@@\":\r\n                    insertTemplateBlock(editor, {templateType: \"date\"})\r\n                    break;\r\n                case \"**\":\r\n                    insertTemplateBlock(editor, {templateType: \"void\"})\r\n                    break;\r\n                case \"##\":\r\n                    insertTemplateBlock(editor, {templateType: \"number\"})\r\n                    break;\r\n                case \"$$\":\r\n                    insertTemplateBlock(editor, {templateType: \"expr\"})\r\n            }\r\n            setInsertTemplate(false);\r\n            setTarget(null);\r\n        }\r\n        // eslint-disable-next-line\r\n    }, [insertTemplate])\r\n\r\n    const onChangeTemplates = useCallback((editor: Editor) => {\r\n        const { selection } = editor;\r\n        if (selection && Range.isCollapsed(selection)) {\r\n            const [start] = Range.edges(selection)\r\n            const {range, match, text} = matchBefore(editor, start, /[{[@*#$]{2}/, {distance: 2});\r\n            if (match) {\r\n                setTarget(range);\r\n                setReplaceText(text!);\r\n                setInsertTemplate(true);\r\n            }\r\n        }\r\n    }, [target, insertTemplate])\r\n    \r\n    const focusActiveTemplate = useCallback((event: React.KeyboardEvent, editor: Editor) => {\r\n        const { selection } = editor;\r\n        if (selection && event.key === \"Enter\") {\r\n            event.preventDefault();\r\n            const [currentNode, currentPath] = Editor.node(editor, selection);\r\n            if (isTemplateBlock(editor, currentPath)) {\r\n                Transforms.setNodes(editor, { activeInput: true }, {at: Path.parent(currentPath)})\r\n                console.log(\"Should somehow focus the ref on the contained input now\", Editor.node(editor, Path.parent(currentPath)))\r\n            }\r\n        }\r\n    }, [])\r\n    \r\n    return {onChangeTemplates, focusActiveTemplate}\r\n}","import styled from 'styled-components';\r\n\r\nexport const EditorContainer = styled.div`\r\n    flex-grow: 1;\r\n    border: 1px solid lightgray;\r\n    border-radius: 5px;\r\n    height: 80vh;\r\n`","import React from 'react'\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\n\r\nexport const HelpModalContent: React.FC =() => {\r\n\r\n    return (\r\n        <>\r\n            <div className=\"modal-body\">\r\n              <p>FastDischarge aims to be an open-source medical documentation platform that is truly <em>fast</em>.</p>\r\n              <p>\r\n                With FastDischarge, you can easily create template fields and prepopulate them with commonly used values of your choice.\r\n                FastDischarge lets you write your progress notes and discharge letters faster, so you can get back to doctoring.\r\n              </p>\r\n              <p>FastDischarge doesn't use any central servers; everything you enter into it is stored locally on your device, so there are no data privacy issues to worry about! (Don't believe me? Check the source code on <a href=\"https://github.com/newageoflight/fast-discharge\">Github</a>!)</p>\r\n              <h2>Usage guide</h2>\r\n\r\n              <h3>Templates</h3>\r\n              <p>With FastDischarge you can create several kinds of template fields:</p>\r\n              <dl>\r\n                <dt>Selection (list)</dt>\r\n                <dd>To select from a simple list of terms (e.g. attending doctors), type in <kbd>{\"{{\"}</kbd></dd>\r\n                <dt>Multiple selection (list)</dt>\r\n                <dd>To select multiple items from a list of terms (e.g. background conditions), type in <kbd>[[</kbd></dd>\r\n                <dt>Dates</dt>\r\n                <dd>To insert a date-picker (e.g. for admission and discharge dates), type in <kbd>@@</kbd></dd>\r\n                <dt>Numbers</dt>\r\n                <dd>To insert a number template, type in <kbd>##</kbd></dd>\r\n                <dt>Formulae</dt>\r\n                <dd>To insert a formula, type in <kbd>$$</kbd>. You can use these to calculate expressions based on the values of other named template fields (similar to say, Excel).\r\n                Formulae are based on Nunjucks/Jinja2 so to find out what is supported, check <a href=\"https://mozilla.github.io/nunjucks/templating.html#expressions\">here</a>. \r\n                More formulae and documentation about them are in the works!</dd>\r\n                <dt>Voids</dt>\r\n                <dd>To insert a void (whose sole purpose is to be given a name and replaced), type in <kbd>**</kbd></dd>\r\n              </dl>\r\n              <p><strong>For list template types, you can set options</strong> by clicking on the dropdown menu and typing in some text.</p>\r\n              <p><strong>Cycle to the next template field</strong> by pressing <kbd>TAB</kbd>; <strong>cycle to the previous template field</strong> by pressing <kbd>Shift+TAB</kbd></p>\r\n              <p>You can also cycle to template fields by pressing <kbd>Ctrl+[</kbd> for the previous and <kbd>Ctrl+]</kbd> for the next</p>\r\n\r\n              <h3>Snippets and dot abbreviations</h3>\r\n              <p>If you frequently use a snippet, you can save it as a <strong>dot abbreviation</strong> by selecting it and clicking the <InlineIcon icon=\"bi:dot\" /> dot icon in the hovering selection menu. You will be asked to give it a name.</p>\r\n              <p>You can later invoke the snippet by typing <kbd>.nameOfYourAbbreviation</kbd>, e.g. if you named it \"cag\" type <kbd>.cag</kbd></p>\r\n              <h3>Finalising documents</h3>\r\n              <p>To finalise your document and <strong>copy its contents as plain text</strong> (e.g. Web DeLacy), press the <InlineIcon icon=\"ion:copy-outline\" /> button in the toolbar.</p>\r\n              <p>To finalise your document and <strong>copy its contents as rich text</strong> (e.g. PowerChart), press the <InlineIcon icon=\"ion:copy\" /> button in the toolbar.</p>\r\n              <h3>Taking your settings with you</h3>\r\n              <p>I'm still not sure if there are legal issues around having user accounts to store your abbreviations, especially when sensitive patient data is concerned, so you'll have to store them as files if you want to take them around.</p>\r\n              <p>For this you can go into the <InlineIcon icon=\"carbon:settings-adjust\" /> settings menu and choose to download or upload your abbreviations.</p>\r\n            </div>\r\n\r\n            <div className=\"modal-footer\">\r\n              <h2>Contributing/credits</h2>\r\n              <p>FastDischarge is still a work in progress, with many new features on the roadmap.</p>\r\n              <p>\r\n                If you have experience working with Slate.js, React.js or Typescript, please consider contributing to this project on <a href=\"https://github.com/newageoflight/fast-discharge\">Github</a>.\r\n              </p>\r\n              <p>Developed by <a href=\"mailto:camint3rnal@live.com\">Christopher Chen</a> (JMO/Intern)</p>\r\n            </div>\r\n      </>\r\n    )\r\n}\r\n","import React, { useState } from 'react';\r\nimport { InlineIcon } from '@iconify/react-with-api';\r\nimport Modal from \"react-modal\";\r\n\r\nimport { TextEditor } from \"./components/TextEditor\"\r\nimport { EditorContainer } from \"./components/EditorContainer\"\r\nimport { HelpModalContent } from './components/HelpModalContent';\r\nimport { OneLine } from './components/OneLine';\r\nimport { FancyButton } from './components/FancyButton';\r\n\r\nimport \"./css/App.css\"\r\nimport logo from \"./dischargeicon.png\"\r\n\r\nModal.setAppElement(\"#root\")\r\n\r\nfunction App() {\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header>\r\n        <h1>\r\n          <img src={logo} alt=\"FastDischarge logo\" style={{display: \"inline-block\", height: \"1.3em\", marginRight: \"2px\", transform: \"translateY(7px)\"}}/>\r\n          FastDischarge\r\n        </h1>\r\n      </header>\r\n      <EditorContainer>\r\n        <TextEditor />\r\n      </EditorContainer>\r\n      <footer>\r\n        <OneLine>\r\n          <p>&copy; <a href=\"https://github.com/newageoflight\">Christopher Chen</a> 2021-</p>\r\n          <FancyButton onClick={() => setModalOpen(true)}>\r\n            <InlineIcon icon=\"bx:bx-help-circle\" />\r\n          </FancyButton>\r\n        </OneLine>\r\n      </footer>\r\n      <Modal isOpen={modalOpen} onRequestClose={() => setModalOpen(false)} contentLabel=\"About FastDischarge\">\r\n        <OneLine>\r\n          <h2 style={{display: \"inline-block\", margin: 0}}>About FastDischarge</h2>\r\n          <FancyButton onClick={() => setModalOpen(false)}><InlineIcon icon=\"eva:close-fill\" /></FancyButton>\r\n        </OneLine>\r\n        <HelpModalContent />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","export default \"data:image/png;base64,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\"","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { RecoilRoot } from 'recoil';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <RecoilRoot>\r\n      <App />\r\n    </RecoilRoot>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}